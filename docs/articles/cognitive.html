<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Code for using the msmbayes package for semi-Markov modelling in an application to cognitive function • msmbayes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Code for using the msmbayes package for semi-Markov modelling in an application to cognitive function">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/examples.html">Examples of using msmbayes</a>
    </li>
    <li>
      <a href="../articles/misclass.html">Misclassification multi-state models in msmbayes</a>
    </li>
    <li>
      <a href="../articles/semimarkov.html">Semi-Markov models with msmbayes</a>
    </li>
    <li>
      <a href="../articles/nphase.html">Advanced phase-type models in msmbayes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chjackson/msmbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Code for using the msmbayes package for
semi-Markov modelling in an application to cognitive function</h1>
                        <h4 data-toc-skip class="author">Christopher
Jackson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msmbayes/blob/HEAD/vignettes/articles/cognitive.Rmd" class="external-link"><code>vignettes/articles/cognitive.Rmd</code></a></small>
      <div class="hidden name"><code>cognitive.Rmd</code></div>

    </div>

    
    
<p>This file gives the code used for the analysis of the cognitive
function data in Section 7 of the paper “Stable and practical
semi-Markov modelling of intermittently-observed data” (Jackson).</p>
<p>It is intended to show that the methodology in the paper can be
easily used in practice. It also serves as an aid to learning Bayesian
multi-state modelling using the <code>msmbayes</code> package, in
conjunction with the other documentation given on the <a href="https://chjackson.github.io/msmbayes">package site</a></p>
<p>Since the original ELSA dataset cannot be redistributed, here we
provide a simulated dataset with the same structure and size. The code
used for the analysis is the same as in the paper, just with different
data. Therefore the code can be run, but the results will be
different.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chjackson/msmbayes" class="external-link">msmbayes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chjackson/msm" class="external-link">msm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.3.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.4     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/" class="external-link">posterior</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is posterior version 1.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'posterior'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     mad, sd, var</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     %in%, match</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"elsa_priors.R"</span><span class="op">)</span></span>
<span><span class="va">Q5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">save_files</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># for local use</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="va">wd</span> <span class="op">&lt;-</span> <span class="st">"../elsa/fakedata"</span></span>
<span> <span class="va">mbmodc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>, <span class="st">"mbmodc.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">mbmodscw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>, <span class="st">"mbmodscg.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">mbmodscg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>, <span class="st">"mbmodscw.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="simulated-data">Simulated data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h2>
<p>A simulated dataset is loaded here, which was produced by simulating
state outcomes from a Markov model fitted to the original ELSA data. The
same number of individuals and observation times are simulated as in the
original data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elsa1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"elsa_fakedata.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-data-summaries">Basic data summaries<a class="anchor" aria-label="anchor" href="#basic-data-summaries"></a>
</h2>
<p>number of observed transitions over an interval between observations.
Overall and split by covariates. Note a small number of deaths from each
state.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/statetable.html">statetable</a></span><span class="op">(</span>state<span class="op">=</span><span class="st">"state"</span>, time<span class="op">=</span><span class="st">"agey"</span>, subject<span class="op">=</span><span class="st">"idauniq"</span>, data<span class="op">=</span><span class="va">elsa1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">#&gt;   fromstate timelag                     `1`   `2`   `3`   `4`   `5`</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 [0.000182005853254452,11]   953   680   238    39    61</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         2 [0.000182005853254452,11]   190   558   342    37    20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         3 [0.000182005853254452,11]    48   220   445   108    10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>         4 [0.000182005853254452,11]     4    17    64   135     7</span></span>
<span><span class="fu"><a href="../reference/statetable.html">statetable</a></span><span class="op">(</span>state<span class="op">=</span><span class="st">"state"</span>, time<span class="op">=</span><span class="st">"agey"</span>, subject<span class="op">=</span><span class="st">"idauniq"</span>, </span>
<span>           covariates <span class="op">=</span> <span class="st">"gender"</span>, data<span class="op">=</span><span class="va">elsa1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 8</span></span></span>
<span><span class="co">#&gt;   fromstate timelag                   gender   `1`   `2`   `3`   `4`   `5`</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 [0.000182005853254452,11] man      377   291   107    20    27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         1 [0.000182005853254452,11] woman    576   389   131    19    34</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         2 [0.000182005853254452,11] man       73   258   167    11     8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>         2 [0.000182005853254452,11] woman    117   300   175    26    12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>         3 [0.000182005853254452,11] man       15   111   237    47     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>         3 [0.000182005853254452,11] woman     33   109   208    61     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>         4 [0.000182005853254452,11] man        4     6    29    50     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>         4 [0.000182005853254452,11] woman      0    11    35    85     4</span></span>
<span><span class="fu"><a href="../reference/statetable.html">statetable</a></span><span class="op">(</span>state<span class="op">=</span><span class="st">"state"</span>, time<span class="op">=</span><span class="st">"agey"</span>, subject<span class="op">=</span><span class="st">"idauniq"</span>, </span>
<span>           covariates <span class="op">=</span> <span class="st">"age10"</span>, data<span class="op">=</span><span class="va">elsa1000</span> <span class="op">|&gt;</span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age10<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">agey</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span>,<span class="fl">70</span>,<span class="fl">80</span>,<span class="fl">110</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age10</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">`5`</span><span class="op">)</span><span class="op">)</span> <span class="co"># deaths by age group </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   age10        n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> (0,60]      28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> (60,70]     40</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> (70,80]     21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> (80,110]     9</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="markov-models-in-msmbayes">Markov models in msmbayes<a class="anchor" aria-label="anchor" href="#markov-models-in-msmbayes"></a>
</h2>
<p>Start with the simplest model with no covariates and default priors,
as a sense check. Looking at just the transition intensities, the
estimates do not look extreme or uncertain, but this is misleading -
when converted to a time scale, the expected times to death (without
competing risks) are implausibly large and uncertain.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mbmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msmbayes.html">msmbayes</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">elsa1000</span>, state<span class="op">=</span><span class="st">"state"</span>, time<span class="op">=</span><span class="st">"agey"</span>, subject<span class="op">=</span><span class="st">"idauniq"</span>,</span>
<span>                  Q<span class="op">=</span><span class="va">Q5</span>, deathexact<span class="op">=</span><span class="cn">TRUE</span>, fit_method<span class="op">=</span><span class="st">"optimize"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mbmod</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 7</span></span></span>
<span><span class="co">#&gt;    name   from    to        posterior    mode prior_string                prior</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> q         1     2  0.4050 <span style="color: #949494;">± 0.0171</span> 0.404   0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> q         1     5  0.0185 <span style="color: #949494;">± 0.0030</span> 0.018<span style="text-decoration: underline;">2</span>  0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> q         2     1  0.2018 <span style="color: #949494;">± 0.0154</span> 0.201   0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> q         2     3  0.3457 <span style="color: #949494;">± 0.0181</span> 0.345   0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> q         2     5  0.0074 <span style="color: #949494;">± 0.0029</span> 0.006<span style="text-decoration: underline;">92</span> 0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> q         3     2  0.3226 <span style="color: #949494;">± 0.0232</span> 0.321   0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> q         3     4  0.1260 <span style="color: #949494;">± 0.0106</span> 0.125   0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> q         3     5  0.0059 <span style="color: #949494;">± 0.0029</span> 0.005<span style="text-decoration: underline;">25</span> 0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> q         4     3  0.2667 <span style="color: #949494;">± 0.0311</span> 0.265   0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> q         4     5  0.0182 <span style="color: #949494;">± 0.0071</span> 0.017<span style="text-decoration: underline;">1</span>  0.14 (0.0027, 6.8)   0.96 <span style="color: #949494;">± 4.4</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> mst       1    <span style="color: #BB0000;">NA</span>  2.3653 <span style="color: #949494;">± 0.0970</span> 2.37    3.7 (0.073, 186)    26.11 <span style="color: #949494;">± 118.8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> mst       2    <span style="color: #BB0000;">NA</span>  1.8052 <span style="color: #949494;">± 0.0761</span> 1.81    2.5 (0.049, 124)    17.41 <span style="color: #949494;">± 79.2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> mst       3    <span style="color: #BB0000;">NA</span>  2.2074 <span style="color: #949494;">± 0.1250</span> 2.21    2.5 (0.049, 124)    17.41 <span style="color: #949494;">± 79.2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> mst       4    <span style="color: #BB0000;">NA</span>  3.5532 <span style="color: #949494;">± 0.3949</span> 3.55    3.7 (0.073, 186)    26.11 <span style="color: #949494;">± 118.8</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mbmod</span>, pars<span class="op">=</span><span class="st">"time"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 7</span></span></span>
<span><span class="co">#&gt;    name   from    to       posterior   mode prior_string              prior</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> time      1     2    2.5 <span style="color: #949494;">± 0.10</span>     2.47 7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> time      1     5   55.6 <span style="color: #949494;">± 8.87</span>    54.8  7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> time      2     1    5.0 <span style="color: #949494;">± 0.38</span>     4.97 7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> time      2     3    2.9 <span style="color: #949494;">± 0.15</span>     2.90 7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> time      2     5  155.0 <span style="color: #949494;">± 59.08</span>  144.   7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> time      3     2    3.1 <span style="color: #949494;">± 0.22</span>     3.11 7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> time      3     4    8.0 <span style="color: #949494;">± 0.67</span>     7.97 7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> time      3     5  213.3 <span style="color: #949494;">± 105.62</span> 190.   7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> time      4     3    3.8 <span style="color: #949494;">± 0.44</span>     3.78 7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> time      4     5   63.4 <span style="color: #949494;">± 25.13</span>   58.5  7.39 (0.1468, 371.9)   52 <span style="color: #949494;">± 238</span></span></span></code></pre></div>
<p>Since there is very little information in this dataset about death,
we obtain strong priors on the death rates from national mortality
statistics. Effects of age/sex on death are from the ONS data. Other
effects are weakly informative: a log-normal(0, 1) distribution supports
hazard ratios up to around <code>exp(2) = 7</code>, which we suppose
would be surprising in the context of demographic effects on the risk of
cognitive decline. The priors are stored in the file
<code>elsa_priors.R</code>, and code used to derive them is in the paper
Supplementary Appendix 4 of the paper.</p>
<p>Now include the covariates in the model, still with a Markov model.
Age-sex interaction and level of education, modifying all transition
rates differently.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mbmodc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msmbayes.html">msmbayes</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">elsa1000</span>, state<span class="op">=</span><span class="st">"state"</span>, time<span class="op">=</span><span class="st">"agey"</span>, subject<span class="op">=</span><span class="st">"idauniq"</span>,</span>
<span>                   Q<span class="op">=</span><span class="va">Q5</span>, deathexact<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                   covariates <span class="op">=</span>  <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                   priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">logq_priors</span>, <span class="va">loghr_priors</span><span class="op">)</span>, <span class="co"># init = list(ini),</span></span>
<span>                   fit_method<span class="op">=</span><span class="st">"optimize"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">mbmodc</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>, <span class="st">"mbmodc.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Standard maximum likelihood estimation in <code>msm</code> appears to
converge, even without any constraints on the parameters, but some
confidence intervals for hazard ratios are implausibly wide.
<code>msmbayes</code> allows use of informative priors to stabilise
computation and support weak data with background information.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msmmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://chjackson.github.io/msm/reference/msm.html" class="external-link">msm</a></span><span class="op">(</span><span class="va">state</span> <span class="op">~</span> <span class="va">agey</span>, subject<span class="op">=</span><span class="va">idauniq</span>, data<span class="op">=</span><span class="va">elsa1000</span>, </span>
<span>              qmatrix<span class="op">=</span><span class="va">Q5</span>, deathexact<span class="op">=</span><span class="cn">TRUE</span>, gen.inits<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>              covariates <span class="op">=</span>  <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>, </span>
<span>              control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale<span class="op">=</span><span class="fl">4000</span>,trace<span class="op">=</span><span class="fl">1</span>,REPORT<span class="op">=</span><span class="fl">1</span>,maxit<span class="op">=</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; initial  value 2.687903 </span></span>
<span><span class="co">#&gt; iter   2 value 2.601472</span></span>
<span><span class="co">#&gt; iter   3 value 2.521311</span></span>
<span><span class="co">#&gt; iter   4 value 2.489134</span></span>
<span><span class="co">#&gt; iter   5 value 2.476426</span></span>
<span><span class="co">#&gt; iter   6 value 2.449580</span></span>
<span><span class="co">#&gt; iter   7 value 2.443327</span></span>
<span><span class="co">#&gt; iter   8 value 2.440236</span></span>
<span><span class="co">#&gt; iter   9 value 2.438421</span></span>
<span><span class="co">#&gt; iter  10 value 2.436899</span></span>
<span><span class="co">#&gt; iter  11 value 2.435912</span></span>
<span><span class="co">#&gt; iter  12 value 2.435151</span></span>
<span><span class="co">#&gt; iter  13 value 2.434511</span></span>
<span><span class="co">#&gt; iter  14 value 2.433812</span></span>
<span><span class="co">#&gt; iter  15 value 2.433168</span></span>
<span><span class="co">#&gt; iter  16 value 2.432669</span></span>
<span><span class="co">#&gt; iter  17 value 2.432313</span></span>
<span><span class="co">#&gt; iter  18 value 2.432051</span></span>
<span><span class="co">#&gt; iter  19 value 2.431865</span></span>
<span><span class="co">#&gt; iter  20 value 2.431717</span></span>
<span><span class="co">#&gt; iter  21 value 2.431564</span></span>
<span><span class="co">#&gt; iter  22 value 2.431401</span></span>
<span><span class="co">#&gt; iter  23 value 2.431233</span></span>
<span><span class="co">#&gt; iter  24 value 2.431052</span></span>
<span><span class="co">#&gt; iter  25 value 2.430862</span></span>
<span><span class="co">#&gt; iter  26 value 2.430696</span></span>
<span><span class="co">#&gt; iter  27 value 2.430568</span></span>
<span><span class="co">#&gt; iter  28 value 2.430458</span></span>
<span><span class="co">#&gt; iter  29 value 2.430331</span></span>
<span><span class="co">#&gt; iter  30 value 2.430172</span></span>
<span><span class="co">#&gt; iter  31 value 2.430018</span></span>
<span><span class="co">#&gt; iter  32 value 2.429919</span></span>
<span><span class="co">#&gt; iter  33 value 2.429856</span></span>
<span><span class="co">#&gt; iter  34 value 2.429791</span></span>
<span><span class="co">#&gt; iter  35 value 2.429717</span></span>
<span><span class="co">#&gt; iter  36 value 2.429641</span></span>
<span><span class="co">#&gt; iter  37 value 2.429571</span></span>
<span><span class="co">#&gt; iter  38 value 2.429503</span></span>
<span><span class="co">#&gt; iter  39 value 2.429433</span></span>
<span><span class="co">#&gt; iter  40 value 2.429367</span></span>
<span><span class="co">#&gt; iter  41 value 2.429311</span></span>
<span><span class="co">#&gt; iter  42 value 2.429256</span></span>
<span><span class="co">#&gt; iter  43 value 2.429196</span></span>
<span><span class="co">#&gt; iter  44 value 2.429141</span></span>
<span><span class="co">#&gt; iter  45 value 2.429101</span></span>
<span><span class="co">#&gt; iter  46 value 2.429068</span></span>
<span><span class="co">#&gt; iter  47 value 2.429025</span></span>
<span><span class="co">#&gt; iter  48 value 2.428967</span></span>
<span><span class="co">#&gt; iter  49 value 2.428912</span></span>
<span><span class="co">#&gt; iter  50 value 2.428877</span></span>
<span><span class="co">#&gt; iter  51 value 2.428852</span></span>
<span><span class="co">#&gt; iter  52 value 2.428819</span></span>
<span><span class="co">#&gt; iter  53 value 2.428773</span></span>
<span><span class="co">#&gt; iter  54 value 2.428727</span></span>
<span><span class="co">#&gt; iter  55 value 2.428699</span></span>
<span><span class="co">#&gt; iter  56 value 2.428683</span></span>
<span><span class="co">#&gt; iter  57 value 2.428664</span></span>
<span><span class="co">#&gt; iter  58 value 2.428635</span></span>
<span><span class="co">#&gt; iter  59 value 2.428604</span></span>
<span><span class="co">#&gt; iter  60 value 2.428586</span></span>
<span><span class="co">#&gt; iter  61 value 2.428578</span></span>
<span><span class="co">#&gt; iter  62 value 2.428571</span></span>
<span><span class="co">#&gt; iter  63 value 2.428557</span></span>
<span><span class="co">#&gt; iter  64 value 2.428535</span></span>
<span><span class="co">#&gt; iter  65 value 2.428506</span></span>
<span><span class="co">#&gt; iter  66 value 2.428480</span></span>
<span><span class="co">#&gt; iter  67 value 2.428457</span></span>
<span><span class="co">#&gt; iter  68 value 2.428426</span></span>
<span><span class="co">#&gt; iter  69 value 2.428383</span></span>
<span><span class="co">#&gt; iter  70 value 2.428339</span></span>
<span><span class="co">#&gt; iter  71 value 2.428314</span></span>
<span><span class="co">#&gt; iter  72 value 2.428301</span></span>
<span><span class="co">#&gt; iter  73 value 2.428289</span></span>
<span><span class="co">#&gt; iter  74 value 2.428270</span></span>
<span><span class="co">#&gt; iter  75 value 2.428249</span></span>
<span><span class="co">#&gt; iter  76 value 2.428236</span></span>
<span><span class="co">#&gt; iter  77 value 2.428230</span></span>
<span><span class="co">#&gt; iter  78 value 2.428224</span></span>
<span><span class="co">#&gt; iter  79 value 2.428211</span></span>
<span><span class="co">#&gt; iter  80 value 2.428187</span></span>
<span><span class="co">#&gt; iter  81 value 2.428152</span></span>
<span><span class="co">#&gt; iter  82 value 2.428124</span></span>
<span><span class="co">#&gt; iter  83 value 2.428109</span></span>
<span><span class="co">#&gt; iter  84 value 2.428101</span></span>
<span><span class="co">#&gt; iter  85 value 2.428088</span></span>
<span><span class="co">#&gt; iter  86 value 2.428068</span></span>
<span><span class="co">#&gt; iter  87 value 2.428043</span></span>
<span><span class="co">#&gt; iter  88 value 2.428024</span></span>
<span><span class="co">#&gt; iter  89 value 2.428009</span></span>
<span><span class="co">#&gt; iter  90 value 2.427992</span></span>
<span><span class="co">#&gt; iter  91 value 2.427969</span></span>
<span><span class="co">#&gt; iter  92 value 2.427948</span></span>
<span><span class="co">#&gt; iter  93 value 2.427935</span></span>
<span><span class="co">#&gt; iter  94 value 2.427928</span></span>
<span><span class="co">#&gt; iter  95 value 2.427917</span></span>
<span><span class="co">#&gt; iter  96 value 2.427898</span></span>
<span><span class="co">#&gt; iter  97 value 2.427871</span></span>
<span><span class="co">#&gt; iter  98 value 2.427848</span></span>
<span><span class="co">#&gt; iter  99 value 2.427837</span></span>
<span><span class="co">#&gt; iter 100 value 2.427829</span></span>
<span><span class="co">#&gt; iter 101 value 2.427816</span></span>
<span><span class="co">#&gt; iter 102 value 2.427796</span></span>
<span><span class="co">#&gt; iter 103 value 2.427770</span></span>
<span><span class="co">#&gt; iter 104 value 2.427748</span></span>
<span><span class="co">#&gt; iter 105 value 2.427731</span></span>
<span><span class="co">#&gt; iter 106 value 2.427709</span></span>
<span><span class="co">#&gt; iter 107 value 2.427672</span></span>
<span><span class="co">#&gt; iter 108 value 2.427625</span></span>
<span><span class="co">#&gt; iter 109 value 2.427592</span></span>
<span><span class="co">#&gt; iter 110 value 2.427581</span></span>
<span><span class="co">#&gt; iter 111 value 2.427579</span></span>
<span><span class="co">#&gt; iter 112 value 2.427576</span></span>
<span><span class="co">#&gt; iter 113 value 2.427570</span></span>
<span><span class="co">#&gt; iter 114 value 2.427558</span></span>
<span><span class="co">#&gt; iter 115 value 2.427540</span></span>
<span><span class="co">#&gt; iter 116 value 2.427527</span></span>
<span><span class="co">#&gt; iter 117 value 2.427521</span></span>
<span><span class="co">#&gt; iter 118 value 2.427519</span></span>
<span><span class="co">#&gt; iter 119 value 2.427515</span></span>
<span><span class="co">#&gt; iter 120 value 2.427508</span></span>
<span><span class="co">#&gt; iter 121 value 2.427497</span></span>
<span><span class="co">#&gt; iter 122 value 2.427486</span></span>
<span><span class="co">#&gt; iter 123 value 2.427484</span></span>
<span><span class="co">#&gt; iter 124 value 2.427480</span></span>
<span><span class="co">#&gt; iter 125 value 2.427478</span></span>
<span><span class="co">#&gt; iter 126 value 2.427473</span></span>
<span><span class="co">#&gt; iter 127 value 2.427470</span></span>
<span><span class="co">#&gt; iter 128 value 2.427468</span></span>
<span><span class="co">#&gt; iter 129 value 2.427466</span></span>
<span><span class="co">#&gt; iter 130 value 2.427462</span></span>
<span><span class="co">#&gt; iter 131 value 2.427459</span></span>
<span><span class="co">#&gt; iter 132 value 2.427457</span></span>
<span><span class="co">#&gt; iter 133 value 2.427455</span></span>
<span><span class="co">#&gt; iter 134 value 2.427452</span></span>
<span><span class="co">#&gt; iter 135 value 2.427448</span></span>
<span><span class="co">#&gt; iter 136 value 2.427443</span></span>
<span><span class="co">#&gt; iter 137 value 2.427438</span></span>
<span><span class="co">#&gt; iter 138 value 2.427435</span></span>
<span><span class="co">#&gt; iter 139 value 2.427433</span></span>
<span><span class="co">#&gt; iter 140 value 2.427431</span></span>
<span><span class="co">#&gt; iter 141 value 2.427429</span></span>
<span><span class="co">#&gt; iter 142 value 2.427426</span></span>
<span><span class="co">#&gt; iter 143 value 2.427423</span></span>
<span><span class="co">#&gt; iter 144 value 2.427419</span></span>
<span><span class="co">#&gt; iter 145 value 2.427415</span></span>
<span><span class="co">#&gt; iter 146 value 2.427411</span></span>
<span><span class="co">#&gt; iter 147 value 2.427407</span></span>
<span><span class="co">#&gt; iter 148 value 2.427402</span></span>
<span><span class="co">#&gt; iter 149 value 2.427397</span></span>
<span><span class="co">#&gt; iter 150 value 2.427393</span></span>
<span><span class="co">#&gt; iter 151 value 2.427391</span></span>
<span><span class="co">#&gt; iter 152 value 2.427390</span></span>
<span><span class="co">#&gt; iter 153 value 2.427388</span></span>
<span><span class="co">#&gt; iter 154 value 2.427386</span></span>
<span><span class="co">#&gt; iter 155 value 2.427383</span></span>
<span><span class="co">#&gt; iter 156 value 2.427379</span></span>
<span><span class="co">#&gt; iter 157 value 2.427377</span></span>
<span><span class="co">#&gt; iter 158 value 2.427374</span></span>
<span><span class="co">#&gt; iter 159 value 2.427373</span></span>
<span><span class="co">#&gt; iter 160 value 2.427370</span></span>
<span><span class="co">#&gt; iter 161 value 2.427367</span></span>
<span><span class="co">#&gt; iter 162 value 2.427364</span></span>
<span><span class="co">#&gt; iter 163 value 2.427362</span></span>
<span><span class="co">#&gt; iter 164 value 2.427360</span></span>
<span><span class="co">#&gt; iter 165 value 2.427358</span></span>
<span><span class="co">#&gt; iter 166 value 2.427355</span></span>
<span><span class="co">#&gt; iter 167 value 2.427353</span></span>
<span><span class="co">#&gt; iter 168 value 2.427350</span></span>
<span><span class="co">#&gt; iter 169 value 2.427348</span></span>
<span><span class="co">#&gt; iter 170 value 2.427346</span></span>
<span><span class="co">#&gt; iter 171 value 2.427343</span></span>
<span><span class="co">#&gt; iter 172 value 2.427339</span></span>
<span><span class="co">#&gt; iter 173 value 2.427336</span></span>
<span><span class="co">#&gt; iter 174 value 2.427334</span></span>
<span><span class="co">#&gt; iter 175 value 2.427333</span></span>
<span><span class="co">#&gt; iter 176 value 2.427331</span></span>
<span><span class="co">#&gt; iter 177 value 2.427329</span></span>
<span><span class="co">#&gt; iter 178 value 2.427326</span></span>
<span><span class="co">#&gt; iter 179 value 2.427324</span></span>
<span><span class="co">#&gt; iter 180 value 2.427321</span></span>
<span><span class="co">#&gt; iter 181 value 2.427318</span></span>
<span><span class="co">#&gt; iter 182 value 2.427316</span></span>
<span><span class="co">#&gt; iter 183 value 2.427314</span></span>
<span><span class="co">#&gt; iter 184 value 2.427312</span></span>
<span><span class="co">#&gt; iter 185 value 2.427309</span></span>
<span><span class="co">#&gt; iter 186 value 2.427304</span></span>
<span><span class="co">#&gt; iter 187 value 2.427298</span></span>
<span><span class="co">#&gt; iter 188 value 2.427295</span></span>
<span><span class="co">#&gt; iter 189 value 2.427293</span></span>
<span><span class="co">#&gt; iter 190 value 2.427291</span></span>
<span><span class="co">#&gt; iter 191 value 2.427288</span></span>
<span><span class="co">#&gt; iter 192 value 2.427286</span></span>
<span><span class="co">#&gt; iter 193 value 2.427285</span></span>
<span><span class="co">#&gt; iter 194 value 2.427284</span></span>
<span><span class="co">#&gt; iter 195 value 2.427282</span></span>
<span><span class="co">#&gt; iter 196 value 2.427280</span></span>
<span><span class="co">#&gt; iter 197 value 2.427276</span></span>
<span><span class="co">#&gt; iter 198 value 2.427273</span></span>
<span><span class="co">#&gt; iter 199 value 2.427271</span></span>
<span><span class="co">#&gt; iter 200 value 2.427270</span></span>
<span><span class="co">#&gt; iter 201 value 2.427267</span></span>
<span><span class="co">#&gt; iter 202 value 2.427264</span></span>
<span><span class="co">#&gt; iter 203 value 2.427262</span></span>
<span><span class="co">#&gt; iter 204 value 2.427260</span></span>
<span><span class="co">#&gt; iter 205 value 2.427258</span></span>
<span><span class="co">#&gt; iter 206 value 2.427256</span></span>
<span><span class="co">#&gt; iter 207 value 2.427252</span></span>
<span><span class="co">#&gt; iter 208 value 2.427248</span></span>
<span><span class="co">#&gt; iter 209 value 2.427246</span></span>
<span><span class="co">#&gt; iter 210 value 2.427245</span></span>
<span><span class="co">#&gt; iter 211 value 2.427243</span></span>
<span><span class="co">#&gt; iter 212 value 2.427240</span></span>
<span><span class="co">#&gt; iter 213 value 2.427236</span></span>
<span><span class="co">#&gt; iter 214 value 2.427233</span></span>
<span><span class="co">#&gt; iter 215 value 2.427232</span></span>
<span><span class="co">#&gt; iter 216 value 2.427231</span></span>
<span><span class="co">#&gt; iter 217 value 2.427230</span></span>
<span><span class="co">#&gt; iter 218 value 2.427228</span></span>
<span><span class="co">#&gt; iter 219 value 2.427226</span></span>
<span><span class="co">#&gt; iter 220 value 2.427224</span></span>
<span><span class="co">#&gt; iter 221 value 2.427223</span></span>
<span><span class="co">#&gt; iter 222 value 2.427221</span></span>
<span><span class="co">#&gt; iter 223 value 2.427217</span></span>
<span><span class="co">#&gt; iter 224 value 2.427215</span></span>
<span><span class="co">#&gt; iter 225 value 2.427213</span></span>
<span><span class="co">#&gt; iter 226 value 2.427212</span></span>
<span><span class="co">#&gt; iter 227 value 2.427211</span></span>
<span><span class="co">#&gt; iter 228 value 2.427208</span></span>
<span><span class="co">#&gt; iter 229 value 2.427204</span></span>
<span><span class="co">#&gt; iter 230 value 2.427201</span></span>
<span><span class="co">#&gt; iter 231 value 2.427200</span></span>
<span><span class="co">#&gt; iter 232 value 2.427200</span></span>
<span><span class="co">#&gt; iter 233 value 2.427199</span></span>
<span><span class="co">#&gt; iter 234 value 2.427196</span></span>
<span><span class="co">#&gt; iter 235 value 2.427191</span></span>
<span><span class="co">#&gt; iter 236 value 2.427185</span></span>
<span><span class="co">#&gt; iter 237 value 2.427181</span></span>
<span><span class="co">#&gt; iter 238 value 2.427180</span></span>
<span><span class="co">#&gt; iter 239 value 2.427179</span></span>
<span><span class="co">#&gt; iter 240 value 2.427178</span></span>
<span><span class="co">#&gt; iter 241 value 2.427175</span></span>
<span><span class="co">#&gt; iter 242 value 2.427172</span></span>
<span><span class="co">#&gt; iter 243 value 2.427169</span></span>
<span><span class="co">#&gt; iter 244 value 2.427169</span></span>
<span><span class="co">#&gt; iter 245 value 2.427168</span></span>
<span><span class="co">#&gt; iter 246 value 2.427167</span></span>
<span><span class="co">#&gt; iter 247 value 2.427166</span></span>
<span><span class="co">#&gt; iter 248 value 2.427166</span></span>
<span><span class="co">#&gt; iter 249 value 2.427165</span></span>
<span><span class="co">#&gt; iter 250 value 2.427165</span></span>
<span><span class="co">#&gt; iter 251 value 2.427164</span></span>
<span><span class="co">#&gt; iter 252 value 2.427163</span></span>
<span><span class="co">#&gt; iter 253 value 2.427162</span></span>
<span><span class="co">#&gt; iter 254 value 2.427162</span></span>
<span><span class="co">#&gt; iter 255 value 2.427161</span></span>
<span><span class="co">#&gt; iter 256 value 2.427160</span></span>
<span><span class="co">#&gt; iter 257 value 2.427159</span></span>
<span><span class="co">#&gt; iter 258 value 2.427158</span></span>
<span><span class="co">#&gt; iter 259 value 2.427158</span></span>
<span><span class="co">#&gt; iter 260 value 2.427158</span></span>
<span><span class="co">#&gt; iter 261 value 2.427157</span></span>
<span><span class="co">#&gt; iter 262 value 2.427156</span></span>
<span><span class="co">#&gt; iter 263 value 2.427156</span></span>
<span><span class="co">#&gt; iter 264 value 2.427155</span></span>
<span><span class="co">#&gt; iter 265 value 2.427155</span></span>
<span><span class="co">#&gt; iter 266 value 2.427155</span></span>
<span><span class="co">#&gt; iter 267 value 2.427154</span></span>
<span><span class="co">#&gt; iter 268 value 2.427153</span></span>
<span><span class="co">#&gt; iter 269 value 2.427152</span></span>
<span><span class="co">#&gt; iter 270 value 2.427151</span></span>
<span><span class="co">#&gt; iter 271 value 2.427150</span></span>
<span><span class="co">#&gt; iter 272 value 2.427149</span></span>
<span><span class="co">#&gt; iter 273 value 2.427148</span></span>
<span><span class="co">#&gt; iter 274 value 2.427147</span></span>
<span><span class="co">#&gt; iter 275 value 2.427147</span></span>
<span><span class="co">#&gt; iter 276 value 2.427147</span></span>
<span><span class="co">#&gt; iter 277 value 2.427146</span></span>
<span><span class="co">#&gt; iter 278 value 2.427145</span></span>
<span><span class="co">#&gt; iter 279 value 2.427145</span></span>
<span><span class="co">#&gt; iter 280 value 2.427144</span></span>
<span><span class="co">#&gt; iter 281 value 2.427144</span></span>
<span><span class="co">#&gt; iter 282 value 2.427143</span></span>
<span><span class="co">#&gt; iter 283 value 2.427143</span></span>
<span><span class="co">#&gt; iter 284 value 2.427142</span></span>
<span><span class="co">#&gt; iter 285 value 2.427142</span></span>
<span><span class="co">#&gt; iter 286 value 2.427141</span></span>
<span><span class="co">#&gt; iter 287 value 2.427141</span></span>
<span><span class="co">#&gt; iter 288 value 2.427140</span></span>
<span><span class="co">#&gt; iter 289 value 2.427139</span></span>
<span><span class="co">#&gt; iter 290 value 2.427138</span></span>
<span><span class="co">#&gt; iter 291 value 2.427138</span></span>
<span><span class="co">#&gt; iter 292 value 2.427138</span></span>
<span><span class="co">#&gt; iter 293 value 2.427137</span></span>
<span><span class="co">#&gt; iter 294 value 2.427137</span></span>
<span><span class="co">#&gt; iter 295 value 2.427136</span></span>
<span><span class="co">#&gt; iter 296 value 2.427136</span></span>
<span><span class="co">#&gt; iter 297 value 2.427135</span></span>
<span><span class="co">#&gt; iter 298 value 2.427135</span></span>
<span><span class="co">#&gt; iter 299 value 2.427134</span></span>
<span><span class="co">#&gt; iter 300 value 2.427134</span></span>
<span><span class="co">#&gt; iter 301 value 2.427134</span></span>
<span><span class="co">#&gt; iter 302 value 2.427133</span></span>
<span><span class="co">#&gt; iter 303 value 2.427133</span></span>
<span><span class="co">#&gt; iter 304 value 2.427133</span></span>
<span><span class="co">#&gt; iter 305 value 2.427132</span></span>
<span><span class="co">#&gt; iter 306 value 2.427132</span></span>
<span><span class="co">#&gt; iter 307 value 2.427131</span></span>
<span><span class="co">#&gt; iter 308 value 2.427130</span></span>
<span><span class="co">#&gt; iter 309 value 2.427129</span></span>
<span><span class="co">#&gt; iter 310 value 2.427129</span></span>
<span><span class="co">#&gt; iter 311 value 2.427129</span></span>
<span><span class="co">#&gt; iter 312 value 2.427128</span></span>
<span><span class="co">#&gt; iter 313 value 2.427128</span></span>
<span><span class="co">#&gt; iter 314 value 2.427127</span></span>
<span><span class="co">#&gt; iter 315 value 2.427127</span></span>
<span><span class="co">#&gt; iter 316 value 2.427127</span></span>
<span><span class="co">#&gt; iter 317 value 2.427126</span></span>
<span><span class="co">#&gt; iter 318 value 2.427125</span></span>
<span><span class="co">#&gt; iter 319 value 2.427125</span></span>
<span><span class="co">#&gt; iter 320 value 2.427124</span></span>
<span><span class="co">#&gt; iter 321 value 2.427124</span></span>
<span><span class="co">#&gt; iter 322 value 2.427123</span></span>
<span><span class="co">#&gt; iter 323 value 2.427121</span></span>
<span><span class="co">#&gt; iter 324 value 2.427120</span></span>
<span><span class="co">#&gt; iter 325 value 2.427119</span></span>
<span><span class="co">#&gt; iter 326 value 2.427118</span></span>
<span><span class="co">#&gt; iter 327 value 2.427118</span></span>
<span><span class="co">#&gt; iter 328 value 2.427117</span></span>
<span><span class="co">#&gt; iter 329 value 2.427116</span></span>
<span><span class="co">#&gt; iter 330 value 2.427115</span></span>
<span><span class="co">#&gt; iter 331 value 2.427115</span></span>
<span><span class="co">#&gt; iter 332 value 2.427114</span></span>
<span><span class="co">#&gt; iter 333 value 2.427114</span></span>
<span><span class="co">#&gt; iter 334 value 2.427113</span></span>
<span><span class="co">#&gt; iter 335 value 2.427112</span></span>
<span><span class="co">#&gt; iter 336 value 2.427111</span></span>
<span><span class="co">#&gt; iter 337 value 2.427111</span></span>
<span><span class="co">#&gt; iter 338 value 2.427110</span></span>
<span><span class="co">#&gt; iter 339 value 2.427108</span></span>
<span><span class="co">#&gt; iter 340 value 2.427107</span></span>
<span><span class="co">#&gt; iter 341 value 2.427106</span></span>
<span><span class="co">#&gt; iter 342 value 2.427105</span></span>
<span><span class="co">#&gt; iter 343 value 2.427105</span></span>
<span><span class="co">#&gt; iter 344 value 2.427104</span></span>
<span><span class="co">#&gt; iter 345 value 2.427103</span></span>
<span><span class="co">#&gt; iter 346 value 2.427102</span></span>
<span><span class="co">#&gt; iter 347 value 2.427102</span></span>
<span><span class="co">#&gt; iter 348 value 2.427101</span></span>
<span><span class="co">#&gt; iter 349 value 2.427101</span></span>
<span><span class="co">#&gt; iter 350 value 2.427100</span></span>
<span><span class="co">#&gt; iter 351 value 2.427099</span></span>
<span><span class="co">#&gt; iter 352 value 2.427098</span></span>
<span><span class="co">#&gt; iter 353 value 2.427098</span></span>
<span><span class="co">#&gt; iter 354 value 2.427097</span></span>
<span><span class="co">#&gt; iter 355 value 2.427097</span></span>
<span><span class="co">#&gt; iter 356 value 2.427096</span></span>
<span><span class="co">#&gt; iter 357 value 2.427095</span></span>
<span><span class="co">#&gt; iter 358 value 2.427095</span></span>
<span><span class="co">#&gt; iter 359 value 2.427095</span></span>
<span><span class="co">#&gt; iter 360 value 2.427094</span></span>
<span><span class="co">#&gt; iter 361 value 2.427093</span></span>
<span><span class="co">#&gt; iter 362 value 2.427092</span></span>
<span><span class="co">#&gt; iter 363 value 2.427092</span></span>
<span><span class="co">#&gt; iter 364 value 2.427092</span></span>
<span><span class="co">#&gt; iter 365 value 2.427091</span></span>
<span><span class="co">#&gt; iter 366 value 2.427090</span></span>
<span><span class="co">#&gt; iter 367 value 2.427090</span></span>
<span><span class="co">#&gt; iter 368 value 2.427089</span></span>
<span><span class="co">#&gt; iter 369 value 2.427089</span></span>
<span><span class="co">#&gt; iter 370 value 2.427089</span></span>
<span><span class="co">#&gt; iter 371 value 2.427088</span></span>
<span><span class="co">#&gt; iter 372 value 2.427088</span></span>
<span><span class="co">#&gt; iter 373 value 2.427088</span></span>
<span><span class="co">#&gt; iter 374 value 2.427088</span></span>
<span><span class="co">#&gt; iter 375 value 2.427088</span></span>
<span><span class="co">#&gt; iter 376 value 2.427087</span></span>
<span><span class="co">#&gt; iter 377 value 2.427087</span></span>
<span><span class="co">#&gt; iter 378 value 2.427087</span></span>
<span><span class="co">#&gt; iter 379 value 2.427087</span></span>
<span><span class="co">#&gt; iter 380 value 2.427086</span></span>
<span><span class="co">#&gt; iter 381 value 2.427086</span></span>
<span><span class="co">#&gt; iter 382 value 2.427085</span></span>
<span><span class="co">#&gt; iter 383 value 2.427085</span></span>
<span><span class="co">#&gt; iter 384 value 2.427085</span></span>
<span><span class="co">#&gt; iter 385 value 2.427085</span></span>
<span><span class="co">#&gt; iter 386 value 2.427084</span></span>
<span><span class="co">#&gt; iter 387 value 2.427084</span></span>
<span><span class="co">#&gt; iter 388 value 2.427083</span></span>
<span><span class="co">#&gt; iter 389 value 2.427083</span></span>
<span><span class="co">#&gt; iter 390 value 2.427083</span></span>
<span><span class="co">#&gt; iter 391 value 2.427082</span></span>
<span><span class="co">#&gt; iter 392 value 2.427082</span></span>
<span><span class="co">#&gt; iter 393 value 2.427081</span></span>
<span><span class="co">#&gt; iter 394 value 2.427081</span></span>
<span><span class="co">#&gt; iter 395 value 2.427081</span></span>
<span><span class="co">#&gt; iter 396 value 2.427080</span></span>
<span><span class="co">#&gt; iter 397 value 2.427080</span></span>
<span><span class="co">#&gt; iter 398 value 2.427080</span></span>
<span><span class="co">#&gt; iter 399 value 2.427080</span></span>
<span><span class="co">#&gt; iter 400 value 2.427079</span></span>
<span><span class="co">#&gt; iter 401 value 2.427079</span></span>
<span><span class="co">#&gt; iter 402 value 2.427079</span></span>
<span><span class="co">#&gt; iter 403 value 2.427079</span></span>
<span><span class="co">#&gt; iter 404 value 2.427079</span></span>
<span><span class="co">#&gt; iter 405 value 2.427078</span></span>
<span><span class="co">#&gt; iter 406 value 2.427078</span></span>
<span><span class="co">#&gt; iter 407 value 2.427077</span></span>
<span><span class="co">#&gt; iter 408 value 2.427077</span></span>
<span><span class="co">#&gt; iter 409 value 2.427077</span></span>
<span><span class="co">#&gt; iter 410 value 2.427077</span></span>
<span><span class="co">#&gt; iter 411 value 2.427077</span></span>
<span><span class="co">#&gt; iter 412 value 2.427077</span></span>
<span><span class="co">#&gt; iter 413 value 2.427077</span></span>
<span><span class="co">#&gt; iter 414 value 2.427077</span></span>
<span><span class="co">#&gt; iter 415 value 2.427076</span></span>
<span><span class="co">#&gt; iter 416 value 2.427076</span></span>
<span><span class="co">#&gt; iter 417 value 2.427076</span></span>
<span><span class="co">#&gt; iter 418 value 2.427076</span></span>
<span><span class="co">#&gt; iter 419 value 2.427076</span></span>
<span><span class="co">#&gt; iter 420 value 2.427076</span></span>
<span><span class="co">#&gt; iter 421 value 2.427076</span></span>
<span><span class="co">#&gt; iter 422 value 2.427075</span></span>
<span><span class="co">#&gt; iter 423 value 2.427075</span></span>
<span><span class="co">#&gt; iter 424 value 2.427075</span></span>
<span><span class="co">#&gt; iter 425 value 2.427075</span></span>
<span><span class="co">#&gt; iter 426 value 2.427075</span></span>
<span><span class="co">#&gt; iter 427 value 2.427075</span></span>
<span><span class="co">#&gt; iter 428 value 2.427075</span></span>
<span><span class="co">#&gt; iter 429 value 2.427074</span></span>
<span><span class="co">#&gt; iter 430 value 2.427074</span></span>
<span><span class="co">#&gt; iter 431 value 2.427074</span></span>
<span><span class="co">#&gt; iter 432 value 2.427074</span></span>
<span><span class="co">#&gt; iter 433 value 2.427074</span></span>
<span><span class="co">#&gt; iter 434 value 2.427074</span></span>
<span><span class="co">#&gt; iter 435 value 2.427074</span></span>
<span><span class="co">#&gt; iter 436 value 2.427074</span></span>
<span><span class="co">#&gt; iter 437 value 2.427074</span></span>
<span><span class="co">#&gt; iter 438 value 2.427074</span></span>
<span><span class="co">#&gt; iter 439 value 2.427073</span></span>
<span><span class="co">#&gt; iter 440 value 2.427073</span></span>
<span><span class="co">#&gt; iter 441 value 2.427073</span></span>
<span><span class="co">#&gt; iter 442 value 2.427073</span></span>
<span><span class="co">#&gt; iter 443 value 2.427073</span></span>
<span><span class="co">#&gt; iter 444 value 2.427073</span></span>
<span><span class="co">#&gt; iter 445 value 2.427073</span></span>
<span><span class="co">#&gt; iter 446 value 2.427073</span></span>
<span><span class="co">#&gt; iter 447 value 2.427073</span></span>
<span><span class="co">#&gt; iter 448 value 2.427073</span></span>
<span><span class="co">#&gt; iter 449 value 2.427072</span></span>
<span><span class="co">#&gt; iter 450 value 2.427072</span></span>
<span><span class="co">#&gt; iter 451 value 2.427072</span></span>
<span><span class="co">#&gt; iter 452 value 2.427072</span></span>
<span><span class="co">#&gt; iter 453 value 2.427072</span></span>
<span><span class="co">#&gt; iter 454 value 2.427072</span></span>
<span><span class="co">#&gt; iter 455 value 2.427072</span></span>
<span><span class="co">#&gt; iter 456 value 2.427072</span></span>
<span><span class="co">#&gt; iter 457 value 2.427071</span></span>
<span><span class="co">#&gt; iter 458 value 2.427071</span></span>
<span><span class="co">#&gt; iter 459 value 2.427071</span></span>
<span><span class="co">#&gt; iter 460 value 2.427071</span></span>
<span><span class="co">#&gt; iter 461 value 2.427071</span></span>
<span><span class="co">#&gt; iter 462 value 2.427071</span></span>
<span><span class="co">#&gt; iter 463 value 2.427070</span></span>
<span><span class="co">#&gt; iter 464 value 2.427070</span></span>
<span><span class="co">#&gt; iter 465 value 2.427070</span></span>
<span><span class="co">#&gt; iter 466 value 2.427070</span></span>
<span><span class="co">#&gt; iter 467 value 2.427070</span></span>
<span><span class="co">#&gt; iter 468 value 2.427070</span></span>
<span><span class="co">#&gt; iter 469 value 2.427070</span></span>
<span><span class="co">#&gt; iter 470 value 2.427070</span></span>
<span><span class="co">#&gt; iter 471 value 2.427070</span></span>
<span><span class="co">#&gt; iter 472 value 2.427069</span></span>
<span><span class="co">#&gt; iter 473 value 2.427069</span></span>
<span><span class="co">#&gt; iter 474 value 2.427069</span></span>
<span><span class="co">#&gt; iter 475 value 2.427069</span></span>
<span><span class="co">#&gt; iter 476 value 2.427069</span></span>
<span><span class="co">#&gt; iter 477 value 2.427069</span></span>
<span><span class="co">#&gt; iter 478 value 2.427069</span></span>
<span><span class="co">#&gt; iter 479 value 2.427068</span></span>
<span><span class="co">#&gt; iter 480 value 2.427068</span></span>
<span><span class="co">#&gt; iter 481 value 2.427068</span></span>
<span><span class="co">#&gt; iter 482 value 2.427068</span></span>
<span><span class="co">#&gt; iter 483 value 2.427068</span></span>
<span><span class="co">#&gt; iter 484 value 2.427067</span></span>
<span><span class="co">#&gt; iter 485 value 2.427067</span></span>
<span><span class="co">#&gt; iter 486 value 2.427067</span></span>
<span><span class="co">#&gt; iter 487 value 2.427066</span></span>
<span><span class="co">#&gt; iter 488 value 2.427066</span></span>
<span><span class="co">#&gt; iter 489 value 2.427066</span></span>
<span><span class="co">#&gt; iter 490 value 2.427066</span></span>
<span><span class="co">#&gt; iter 491 value 2.427066</span></span>
<span><span class="co">#&gt; iter 492 value 2.427066</span></span>
<span><span class="co">#&gt; iter 493 value 2.427066</span></span>
<span><span class="co">#&gt; iter 494 value 2.427065</span></span>
<span><span class="co">#&gt; iter 495 value 2.427065</span></span>
<span><span class="co">#&gt; iter 496 value 2.427065</span></span>
<span><span class="co">#&gt; iter 497 value 2.427065</span></span>
<span><span class="co">#&gt; iter 498 value 2.427065</span></span>
<span><span class="co">#&gt; iter 499 value 2.427065</span></span>
<span><span class="co">#&gt; iter 500 value 2.427065</span></span>
<span><span class="co">#&gt; iter 501 value 2.427065</span></span>
<span><span class="co">#&gt; iter 502 value 2.427065</span></span>
<span><span class="co">#&gt; iter 503 value 2.427065</span></span>
<span><span class="co">#&gt; iter 504 value 2.427065</span></span>
<span><span class="co">#&gt; iter 505 value 2.427065</span></span>
<span><span class="co">#&gt; iter 506 value 2.427065</span></span>
<span><span class="co">#&gt; iter 507 value 2.427064</span></span>
<span><span class="co">#&gt; iter 508 value 2.427064</span></span>
<span><span class="co">#&gt; iter 509 value 2.427064</span></span>
<span><span class="co">#&gt; iter 510 value 2.427064</span></span>
<span><span class="co">#&gt; iter 511 value 2.427064</span></span>
<span><span class="co">#&gt; iter 512 value 2.427064</span></span>
<span><span class="co">#&gt; iter 513 value 2.427064</span></span>
<span><span class="co">#&gt; iter 514 value 2.427064</span></span>
<span><span class="co">#&gt; iter 515 value 2.427064</span></span>
<span><span class="co">#&gt; iter 516 value 2.427064</span></span>
<span><span class="co">#&gt; iter 517 value 2.427064</span></span>
<span><span class="co">#&gt; iter 518 value 2.427063</span></span>
<span><span class="co">#&gt; iter 519 value 2.427063</span></span>
<span><span class="co">#&gt; iter 520 value 2.427063</span></span>
<span><span class="co">#&gt; iter 521 value 2.427063</span></span>
<span><span class="co">#&gt; iter 522 value 2.427063</span></span>
<span><span class="co">#&gt; iter 523 value 2.427063</span></span>
<span><span class="co">#&gt; iter 524 value 2.427063</span></span>
<span><span class="co">#&gt; iter 525 value 2.427063</span></span>
<span><span class="co">#&gt; iter 526 value 2.427063</span></span>
<span><span class="co">#&gt; iter 527 value 2.427063</span></span>
<span><span class="co">#&gt; iter 528 value 2.427063</span></span>
<span><span class="co">#&gt; iter 529 value 2.427063</span></span>
<span><span class="co">#&gt; iter 530 value 2.427062</span></span>
<span><span class="co">#&gt; iter 531 value 2.427062</span></span>
<span><span class="co">#&gt; iter 532 value 2.427062</span></span>
<span><span class="co">#&gt; iter 533 value 2.427062</span></span>
<span><span class="co">#&gt; iter 534 value 2.427062</span></span>
<span><span class="co">#&gt; iter 535 value 2.427062</span></span>
<span><span class="co">#&gt; iter 536 value 2.427062</span></span>
<span><span class="co">#&gt; iter 537 value 2.427062</span></span>
<span><span class="co">#&gt; iter 538 value 2.427062</span></span>
<span><span class="co">#&gt; iter 539 value 2.427062</span></span>
<span><span class="co">#&gt; iter 540 value 2.427062</span></span>
<span><span class="co">#&gt; iter 540 value 2.427062</span></span>
<span><span class="co">#&gt; iter 540 value 2.427062</span></span>
<span><span class="co">#&gt; final  value 2.427062 </span></span>
<span><span class="co">#&gt; converged</span></span>
<span><span class="co">#&gt; Used 542 function and 540 gradient evaluations</span></span>
<span><span class="fu"><a href="https://chjackson.github.io/msm/reference/hazard.msm.html" class="external-link">hazard.msm</a></span><span class="op">(</span><span class="va">msmmod</span><span class="op">)</span></span>
<span><span class="co">#&gt; $genderwoman</span></span>
<span><span class="co">#&gt;                          HR            L            U</span></span>
<span><span class="co">#&gt; State 1 - State 2 0.9603818 7.090881e-01 1.300731e+00</span></span>
<span><span class="co">#&gt; State 1 - State 5 0.6490433 2.223327e-01 1.894715e+00</span></span>
<span><span class="co">#&gt; State 2 - State 1 1.2967242 6.669284e-01 2.521251e+00</span></span>
<span><span class="co">#&gt; State 2 - State 3 1.1585799 7.733754e-01 1.735648e+00</span></span>
<span><span class="co">#&gt; State 2 - State 5 2.8954462 1.504238e-01 5.573327e+01</span></span>
<span><span class="co">#&gt; State 3 - State 2 1.4126210 7.502159e-01 2.659898e+00</span></span>
<span><span class="co">#&gt; State 3 - State 4 1.6064021 7.470389e-01 3.454342e+00</span></span>
<span><span class="co">#&gt; State 3 - State 5 0.9840856 8.375991e-08 1.156191e+07</span></span>
<span><span class="co">#&gt; State 4 - State 3 1.0412543 3.585527e-01 3.023852e+00</span></span>
<span><span class="co">#&gt; State 4 - State 5 2.0375952 1.486375e-01 2.793235e+01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $y5010</span></span>
<span><span class="co">#&gt;                          HR         L         U</span></span>
<span><span class="co">#&gt; State 1 - State 2 0.9919275 0.8704663  1.130337</span></span>
<span><span class="co">#&gt; State 1 - State 5 0.9523135 0.6099833  1.486764</span></span>
<span><span class="co">#&gt; State 2 - State 1 0.9481615 0.7189083  1.250521</span></span>
<span><span class="co">#&gt; State 2 - State 3 1.1828684 0.9962667  1.404421</span></span>
<span><span class="co">#&gt; State 2 - State 5 1.2446084 0.4689087  3.303522</span></span>
<span><span class="co">#&gt; State 3 - State 2 1.2617222 0.9840197  1.617796</span></span>
<span><span class="co">#&gt; State 3 - State 4 0.8786238 0.6470422  1.193090</span></span>
<span><span class="co">#&gt; State 3 - State 5 3.3322781 0.2204045 50.380452</span></span>
<span><span class="co">#&gt; State 4 - State 3 0.7419514 0.4914210  1.120204</span></span>
<span><span class="co">#&gt; State 4 - State 5 0.6435016 0.2044546  2.025361</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $raeducluppersec</span></span>
<span><span class="co">#&gt;                          HR          L           U</span></span>
<span><span class="co">#&gt; State 1 - State 2 1.0349711 0.85487983    1.253001</span></span>
<span><span class="co">#&gt; State 1 - State 5 1.3954669 0.65206990    2.986379</span></span>
<span><span class="co">#&gt; State 2 - State 1 1.0707526 0.76599105    1.496768</span></span>
<span><span class="co">#&gt; State 2 - State 3 1.1060680 0.86665113    1.411625</span></span>
<span><span class="co">#&gt; State 2 - State 5 5.4246401 0.01726260 1704.651578</span></span>
<span><span class="co">#&gt; State 3 - State 2 0.9513119 0.67022597    1.350282</span></span>
<span><span class="co">#&gt; State 3 - State 4 1.2107354 0.79214271    1.850525</span></span>
<span><span class="co">#&gt; State 3 - State 5 1.2663330 0.01028868  155.860486</span></span>
<span><span class="co">#&gt; State 4 - State 3 0.9649467 0.53140143    1.752201</span></span>
<span><span class="co">#&gt; State 4 - State 5 0.6182428 0.13738921    2.782053</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $raeducltertiary</span></span>
<span><span class="co">#&gt;                            HR            L            U</span></span>
<span><span class="co">#&gt; State 1 - State 2 0.997141002 7.811159e-01    1.2729100</span></span>
<span><span class="co">#&gt; State 1 - State 5 1.247979897 4.314819e-01    3.6095457</span></span>
<span><span class="co">#&gt; State 2 - State 1 0.885078025 5.649087e-01    1.3867076</span></span>
<span><span class="co">#&gt; State 2 - State 3 1.033308440 7.602864e-01    1.4043738</span></span>
<span><span class="co">#&gt; State 2 - State 5 6.590408548 1.625101e-02 2672.6630883</span></span>
<span><span class="co">#&gt; State 3 - State 2 0.968283667 6.268514e-01    1.4956867</span></span>
<span><span class="co">#&gt; State 3 - State 4 0.856040385 5.069047e-01    1.4456467</span></span>
<span><span class="co">#&gt; State 3 - State 5 4.206708439 6.924609e-02  255.5580385</span></span>
<span><span class="co">#&gt; State 4 - State 3 0.444456031 2.056360e-01    0.9606353</span></span>
<span><span class="co">#&gt; State 4 - State 5 0.009210946 1.001644e-06   84.7022825</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`genderwoman:y5010`</span></span>
<span><span class="co">#&gt;                          HR           L          U</span></span>
<span><span class="co">#&gt; State 1 - State 2 0.9789217 0.824762202   1.161896</span></span>
<span><span class="co">#&gt; State 1 - State 5 1.2412095 0.674632911   2.283614</span></span>
<span><span class="co">#&gt; State 2 - State 1 1.0057234 0.713281660   1.418065</span></span>
<span><span class="co">#&gt; State 2 - State 3 0.8666753 0.693145917   1.083648</span></span>
<span><span class="co">#&gt; State 2 - State 5 0.5585449 0.081260720   3.839154</span></span>
<span><span class="co">#&gt; State 3 - State 2 0.8622604 0.633350876   1.173904</span></span>
<span><span class="co">#&gt; State 3 - State 4 0.8567347 0.584937871   1.254825</span></span>
<span><span class="co">#&gt; State 3 - State 5 0.8518272 0.005600282 129.566616</span></span>
<span><span class="co">#&gt; State 4 - State 3 0.8087406 0.481275351   1.359017</span></span>
<span><span class="co">#&gt; State 4 - State 5 0.5060219 0.103138691   2.482659</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="semi-markov-models-in-msmbayes">Semi-Markov models in msmbayes<a class="anchor" aria-label="anchor" href="#semi-markov-models-in-msmbayes"></a>
</h2>
<p>Gamma phase-type sojourn distribution, fitted using optimization to
find the posterior mode, followed by Laplace approximation. This may
take at least 20 minutes to run.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mbmodscg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msmbayes.html">msmbayes</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">elsa1000</span>, state<span class="op">=</span><span class="st">"state"</span>, time<span class="op">=</span><span class="st">"agey"</span>, subject<span class="op">=</span><span class="st">"idauniq"</span>,</span>
<span>                    Q<span class="op">=</span><span class="va">Q5</span>, deathexact<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                    covariates <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span></span>
<span>                    <span class="op">)</span>,</span>
<span>                    pastates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, panphase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>, pafamily<span class="op">=</span><span class="st">"gamma"</span>,</span>
<span>                    priors <span class="op">=</span> <span class="fu">smm_priors</span><span class="op">(</span><span class="st">"gamma"</span><span class="op">)</span>, </span>
<span>                    fit_method<span class="op">=</span><span class="st">"optimize"</span>, verbose<span class="op">=</span><span class="cn">TRUE</span></span>
<span>                    <span class="op">)</span></span>
<span><span class="co">#&gt; Chain 1: Initial log joint probability = -9481.36</span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       19      -5137.73       0.44131       546.938      0.4143           1       23   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       39      -5043.36      0.258403       84.1475           1           1       44   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       59      -5010.28      0.177462       54.8909       4.635      0.4635       67   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       79       -5002.6     0.0447207       65.8073           1           1       88   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       99       -4994.9     0.0617935       31.8579      0.1283           1      113   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      119      -4992.04     0.0269315       14.5146       0.879       0.879      136   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      139      -4989.25       0.02881       15.9708           1           1      157   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      159      -4987.68     0.0624201       19.9807           1           1      178   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      179      -4986.79     0.0179464       11.3401           1           1      199   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      199      -4986.33     0.0352893       24.3528           1           1      222   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      219      -4986.08     0.0183415       9.31246           1           1      243   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      239      -4985.93     0.0111617       5.35717           1           1      264   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      259      -4985.86   0.000979791       3.47356           1           1      285   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      279      -4985.82    0.00905237       6.44122      0.4909           1      307   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      299      -4985.77    0.00688181       2.21536           1           1      330   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      319      -4985.74    0.00939956       7.16472           1           1      352   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      339      -4985.72   0.000655009       3.28335      0.7078      0.7078      374   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      359       -4985.7    0.00952507       1.69175           1           1      394   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      379      -4985.69    0.00081138       1.15741      0.7683      0.7683      416   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      399      -4985.68   0.000714202      0.859757           1           1      437   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      419      -4985.68    0.00178726      0.996528           1           1      457   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      439      -4985.68   0.000162596      0.308238           1           1      477   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      459      -4985.67   0.000802631      0.645748      0.4443           1      500   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      466      -4985.67   0.000296846      0.164274           1           1      507   </span></span>
<span><span class="co">#&gt; Chain 1: Optimization terminated normally: </span></span>
<span><span class="co">#&gt; Chain 1:   Convergence detected: relative gradient magnitude is below tolerance</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">mbmodscg</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>, <span class="st">"mbmodscg.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Weibull phase-type sojourn distribution</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">21</span><span class="op">)</span> </span>
<span><span class="va">mbmodscw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msmbayes.html">msmbayes</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">elsa1000</span>, state<span class="op">=</span><span class="st">"state"</span>, time<span class="op">=</span><span class="st">"agey"</span>, subject<span class="op">=</span><span class="st">"idauniq"</span>,</span>
<span>                    Q<span class="op">=</span><span class="va">Q5</span>, deathexact<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                    covariates <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span>,</span>
<span>                                        <span class="fu"><a href="../reference/rrnextdoc.html">rrnext</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">~</span> <span class="va">gender</span><span class="op">*</span><span class="va">y5010</span> <span class="op">+</span> <span class="va">raeducl</span></span>
<span>                    <span class="op">)</span>,</span>
<span>                    pastates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, panphase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>, pafamily<span class="op">=</span><span class="st">"weibull"</span>,</span>
<span>                    priors <span class="op">=</span> <span class="fu">smm_priors</span><span class="op">(</span><span class="st">"weibull"</span><span class="op">)</span>, </span>
<span>                    fit_method<span class="op">=</span><span class="st">"optimize"</span>, verbose<span class="op">=</span><span class="cn">TRUE</span></span>
<span>                    <span class="op">)</span></span>
<span><span class="co">#&gt; Chain 1: Initial log joint probability = -9283.75</span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       19      -5042.09      0.168618       168.332           1           1       21   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       39      -4985.89      0.179635       61.7231      0.8825      0.8825       44   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       59      -4970.37     0.0998152       22.0104           1           1       65   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       79      -4963.06      0.165702       37.8303           1           1       85   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:       99      -4960.83      0.117115       17.9667           1           1      106   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      119      -4959.76     0.0212664       11.9248           1           1      126   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      139      -4959.34    0.00391426       10.0809       0.543       0.543      147   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      159      -4959.02      0.015866       4.11152           1           1      168   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      179      -4958.86    0.00482594       3.91112      0.3794      0.3794      191   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      199      -4958.77     0.0075008       1.46946           1           1      213   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      219      -4958.74    0.00863967       1.12792           1           1      233   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      239      -4958.73    0.00118623      0.548159           1           1      253   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      259      -4958.73    0.00182506       1.06109           1           1      275   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      279      -4958.72    0.00339834      0.915729      0.5198           1      297   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      299      -4958.72   0.000781237      0.340255       0.351       0.351      320   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      319      -4958.72    0.00306616      0.442573           1           1      341   </span></span>
<span><span class="co">#&gt; Chain 1:     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes </span></span>
<span><span class="co">#&gt; Chain 1:      325      -4958.72   0.000956368     0.0933526           1           1      348   </span></span>
<span><span class="co">#&gt; Chain 1: Optimization terminated normally: </span></span>
<span><span class="co">#&gt; Chain 1:   Convergence detected: relative gradient magnitude is below tolerance</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">mbmodscw</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>, <span class="st">"mbmodscw.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html" class="external-link">mcmc_trace</a></span><span class="op">(</span><span class="va">mbmodscw</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"shape"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Dropping 'draws_df' class as required metadata was removed.</span></span></code></pre></div>
<p><img src="cognitive_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="section level3">
<h3 id="likelihood-based-model-comparison">Likelihood-based model comparison<a class="anchor" aria-label="anchor" href="#likelihood-based-model-comparison"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"The maximised log posterior is %s for the Markov model, %s for the Gamma semi-Markov model and %s for the Weibull semi-Markov model."</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">mbmodc</span><span class="op">)</span><span class="op">$</span><span class="va">mode</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">mbmodscg</span><span class="op">)</span><span class="op">$</span><span class="va">mode</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">mbmodscw</span><span class="op">)</span><span class="op">$</span><span class="va">mode</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The maximised log posterior is -4941 for the Markov model, -4986 for the Gamma semi-Markov model and -4959 for the Weibull semi-Markov model."</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="table-of-basic-parameter-estimates">Table of basic parameter estimates<a class="anchor" aria-label="anchor" href="#table-of-basic-parameter-estimates"></a>
</h3>
<p>Sojourn times, next-state probabilities and shape parameters</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trans_to_ttype</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span><span class="op">)</span><span class="op">{</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">to</span><span class="op">==</span><span class="fl">5</span>, <span class="st">"Death"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">from</span> <span class="op">&lt;</span> <span class="va">to</span>, <span class="st">"Progression"</span>, <span class="st">"Recovery"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">pn_markov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnext.html">pnext</a></span><span class="op">(</span><span class="va">mbmodc</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span>, <span class="va">posterior</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ttype <span class="op">=</span> <span class="fu">trans_to_ttype</span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"from"</span><span class="op">)</span>, values_from<span class="op">=</span><span class="st">"posterior"</span>, names_from<span class="op">=</span><span class="st">"ttype"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>state<span class="op">=</span><span class="va">from</span>, <span class="va">`Progression`</span>,<span class="va">`Recovery`</span>,<span class="va">`Death`</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mst <span class="op">=</span> <span class="fu"><a href="../reference/mean_sojourn.html">mean_sojourn</a></span><span class="op">(</span><span class="va">mbmodc</span><span class="op">)</span><span class="op">$</span><span class="va">posterior</span>,</span>
<span>         model <span class="op">=</span> <span class="st">"Markov"</span>,</span>
<span>         shape <span class="op">=</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar.html" class="external-link">rvar</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">state</span>, <span class="va">mst</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pn_semi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnext.html">pnext</a></span><span class="op">(</span><span class="va">mbmodscw</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span>, <span class="va">posterior</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ttype <span class="op">=</span> <span class="fu">trans_to_ttype</span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"from"</span><span class="op">)</span>, values_from<span class="op">=</span><span class="st">"posterior"</span>, names_from<span class="op">=</span><span class="st">"ttype"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>state<span class="op">=</span><span class="va">from</span>, <span class="va">`Progression`</span>,<span class="va">`Recovery`</span>,<span class="va">`Death`</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mst <span class="op">=</span> <span class="fu"><a href="../reference/mean_sojourn.html">mean_sojourn</a></span><span class="op">(</span><span class="va">mbmodscw</span><span class="op">)</span><span class="op">$</span><span class="va">posterior</span>,</span>
<span>         model <span class="op">=</span> <span class="st">"Semi-Markov"</span>,</span>
<span>         shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mbmodscw</span>, pars<span class="op">=</span><span class="st">"shape"</span><span class="op">)</span><span class="op">$</span><span class="va">posterior</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">state</span>, <span class="va">mst</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rvar_to_ci</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="va">summf</span> <span class="op">&lt;-</span> <span class="va">summ</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"50%"</span>,<span class="st">"2.5%"</span>,<span class="st">"97.5%"</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>,<span class="fl">2</span><span class="op">)</span>,nsmall<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">summ</span><span class="op">[[</span><span class="st">"50%"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">""</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s \\newline {\\footnotesize (%s, %s)}"</span>, <span class="va">summf</span><span class="op">[[</span><span class="st">"50%"</span><span class="op">]</span><span class="op">]</span>, <span class="va">summf</span><span class="op">[[</span><span class="st">"2.5%"</span><span class="op">]</span><span class="op">]</span>, <span class="va">summf</span><span class="op">[[</span><span class="st">"97.5%"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://gt.rstudio.com/reference/latex.html" class="external-link">latex</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">pn_markov</span>, <span class="va">pn_semi</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">model</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">mst</span><span class="op">:</span><span class="va">shape</span>, <span class="va">rvar_to_ci</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">tab</span>, sep<span class="op">=</span><span class="st">"  &amp;  "</span>, eol<span class="op">=</span><span class="st">"\\\\\n"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, quote<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; state  &amp;  mst  &amp;  Progression  &amp;  Recovery  &amp;  Death  &amp;  shape\\</span></span>
<span><span class="co">#&gt; 1  &amp;  3.04 \newline {\footnotesize (2.39, 3.87)}  &amp;  0.98 \newline {\footnotesize (0.97, 0.99)}  &amp;    &amp;  0.02 \newline {\footnotesize (0.01, 0.03)}  &amp;  \\</span></span>
<span><span class="co">#&gt; 2  &amp;  2.47 \newline {\footnotesize (1.84, 3.31)}  &amp;  0.66 \newline {\footnotesize (0.51, 0.78)}  &amp;  0.33 \newline {\footnotesize (0.21, 0.49)}  &amp;  0.00 \newline {\footnotesize (0.00, 0.01)}  &amp;  \\</span></span>
<span><span class="co">#&gt; 3  &amp;  2.99 \newline {\footnotesize (1.91, 4.54)}  &amp;  0.35 \newline {\footnotesize (0.19, 0.56)}  &amp;  0.64 \newline {\footnotesize (0.43, 0.81)}  &amp;  0.01 \newline {\footnotesize (0.00, 0.01)}  &amp;  \\</span></span>
<span><span class="co">#&gt; 4  &amp;  1.94 \newline {\footnotesize (0.76, 4.73)}  &amp;    &amp;  0.99 \newline {\footnotesize (0.98, 1.00)}  &amp;  0.01 \newline {\footnotesize (0.00, 0.02)}  &amp;  \\</span></span>
<span><span class="co">#&gt; 1  &amp;  2.46 \newline {\footnotesize (1.94, 3.22)}  &amp;  0.96 \newline {\footnotesize (0.91, 0.98)}  &amp;    &amp;  0.04 \newline {\footnotesize (0.02, 0.09)}  &amp;  0.96 \newline {\footnotesize (0.88, 1.04)}\\</span></span>
<span><span class="co">#&gt; 2  &amp;  2.45 \newline {\footnotesize (1.80, 3.31)}  &amp;  0.59 \newline {\footnotesize (0.45, 0.73)}  &amp;  0.39 \newline {\footnotesize (0.26, 0.54)}  &amp;  0.01 \newline {\footnotesize (0.00, 0.04)}  &amp;  0.99 \newline {\footnotesize (0.89, 1.07)}\\</span></span>
<span><span class="co">#&gt; 3  &amp;  3.52 \newline {\footnotesize (2.21, 5.57)}  &amp;  0.34 \newline {\footnotesize (0.19, 0.54)}  &amp;  0.63 \newline {\footnotesize (0.44, 0.79)}  &amp;  0.01 \newline {\footnotesize (0.00, 0.09)}  &amp;  0.94 \newline {\footnotesize (0.81, 1.06)}\\</span></span>
<span><span class="co">#&gt; 4  &amp;  2.53 \newline {\footnotesize (1.19, 5.30)}  &amp;    &amp;  0.92 \newline {\footnotesize (0.63, 0.99)}  &amp;  0.08 \newline {\footnotesize (0.01, 0.37)}  &amp;  1.12 \newline {\footnotesize (0.84, 1.34)}\\</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="covariate-effects">Covariate effects<a class="anchor" aria-label="anchor" href="#covariate-effects"></a>
</h3>
<p>Form a tidy data frame with estimates and CIs to be plotted</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mbmodc</span>, pars<span class="op">=</span><span class="st">"hr"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ttype <span class="op">=</span> <span class="fu">trans_to_ttype</span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span><span class="op">)</span>,</span>
<span>         model <span class="op">=</span> <span class="st">"Markov"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">from</span>, <span class="va">name</span>, <span class="va">ttype</span>, <span class="va">posterior</span>, prior<span class="op">=</span><span class="va">prior</span><span class="op">)</span></span>
<span><span class="va">tafs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mbmodscw</span>, pars<span class="op">=</span><span class="st">"taf"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model<span class="op">=</span><span class="st">"Semi-Markov"</span>, ttype <span class="op">=</span> <span class="st">"Sojourn"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">from</span>, <span class="va">name</span>, <span class="va">ttype</span>, <span class="va">posterior</span>, <span class="va">prior</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trans_to_ttype_rr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span><span class="op">)</span><span class="op">{</span> </span>
<span>  <span class="va">ttype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">to</span><span class="op">==</span><span class="fl">5</span>, <span class="st">"Death"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">from</span> <span class="op">&lt;</span> <span class="va">to</span>, <span class="st">"Progression"</span>, <span class="st">"Recovery"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">from</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"Progression"</span>, <span class="st">"Recovery"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s/%s"</span>,<span class="va">ttype</span>,<span class="va">base</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">rrnexts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mbmodscw</span>,pars <span class="op">=</span> <span class="st">"rrnext"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ttype <span class="op">=</span> <span class="fu">trans_to_ttype_rr</span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span><span class="op">)</span>,</span>
<span>         model <span class="op">=</span> <span class="st">"Semi-Markov"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">from</span>, <span class="va">name</span>, <span class="va">ttype</span>, <span class="va">posterior</span>, prior<span class="op">=</span><span class="va">prior</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cov_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female (for age 50)"</span><span class="op">=</span><span class="st">"genderwoman"</span>,</span>
<span>               <span class="st">"Age: 10 years (for female)"</span><span class="op">=</span><span class="st">"ageeff_woman"</span>,</span>
<span>               <span class="st">"Education: tertiary"</span><span class="op">=</span><span class="st">"raeducltertiary"</span>,</span>
<span>               <span class="st">"Education: upper secondary"</span><span class="op">=</span><span class="st">"raeducluppersec"</span>,</span>
<span>               <span class="st">"Age: 10 years (for male)"</span><span class="op">=</span><span class="st">"y5010"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">covres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">hrs</span>, <span class="va">tafs</span>, <span class="va">rrnexts</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Posterior<span class="op">=</span><span class="va">posterior</span>, Prior<span class="op">=</span><span class="va">prior</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Posterior"</span>, <span class="st">"Prior"</span><span class="op">)</span>, names_to<span class="op">=</span><span class="st">"dist"</span>, values_to<span class="op">=</span><span class="st">"value"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".+\\((.+)\\)"</span>,<span class="st">"\\1"</span>, <span class="va">name</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">inter</span> <span class="op">&lt;-</span> <span class="va">covres</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span><span class="op">==</span><span class="st">"genderwoman:y5010"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">covres</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span><span class="op">==</span><span class="st">"y5010"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ageeff<span class="op">=</span><span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">name</span><span class="op">)</span>,</span>
<span>            by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">from</span>, <span class="va">ttype</span>, <span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">value</span> <span class="op">*</span> <span class="va">ageeff</span>,</span>
<span>         name <span class="op">=</span> <span class="st">"ageeff_woman"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">from</span>, <span class="va">name</span>, <span class="va">ttype</span>, <span class="va">dist</span>, <span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covres</span> <span class="op">&lt;-</span> <span class="va">covres</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">!=</span> <span class="st">"genderwoman:y5010"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">inter</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">value</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="va">value</span><span class="op">$</span><span class="va">`2.5%`</span>, median <span class="op">=</span> <span class="va">value</span><span class="op">$</span><span class="va">`50%`</span>, upper <span class="op">=</span> <span class="va">value</span><span class="op">$</span><span class="va">`97.5%`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">from</span>, <span class="va">name</span>, <span class="va">ttype</span>, <span class="va">dist</span>, <span class="va">lower</span>, <span class="va">median</span>, <span class="va">upper</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html" class="external-link">fct_relevel</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"y5010"</span>, <span class="st">"ageeff_woman"</span>,</span>
<span>                            <span class="st">"genderwoman"</span>,<span class="st">"raeducluppersec"</span>,</span>
<span>                            <span class="st">"raeducltertiary"</span><span class="op">)</span>,</span>
<span>                            name <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">name</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">cov_codes</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Plot for Markov and semi-Markov separately</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">covres</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">model</span><span class="op">==</span><span class="st">"Markov"</span>, <span class="va">dist</span><span class="op">==</span><span class="st">"Posterior"</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">median</span>, x<span class="op">=</span><span class="va">from</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span>ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, cols<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">ttype</span><span class="op">)</span>, </span>
<span>             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labellers.html" class="external-link">label_wrap_gen</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="st">"gray70"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_linerange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">lower</span>, ymax<span class="op">=</span><span class="va">upper</span><span class="op">)</span>, </span>
<span>                 position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>,</span>
<span>                 show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Hazard ratio"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"From state"</span><span class="op">)</span></span>
<span><span class="va">p</span> </span></code></pre></div>
<p><img src="cognitive_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"../paper/figures/elsa_hrs.pdf"</span>,width<span class="op">=</span><span class="fl">5</span>,height<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="va">p</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">covres</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">model</span><span class="op">==</span><span class="st">"Semi-Markov"</span>, <span class="va">dist</span><span class="op">==</span><span class="st">"Posterior"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ttype <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html" class="external-link">fct_relevel</a></span><span class="op">(</span><span class="va">ttype</span>, <span class="st">"Sojourn"</span>, <span class="st">"Death/Progression"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">median</span>, x<span class="op">=</span><span class="va">from</span>, lty<span class="op">=</span><span class="va">dist</span>, col<span class="op">=</span><span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span>ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, cols<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">ttype</span><span class="op">)</span>, scales<span class="op">=</span><span class="st">"free_y"</span>, </span>
<span>             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labellers.html" class="external-link">label_wrap_gen</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="st">"gray70"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_linerange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">lower</span>, ymax<span class="op">=</span><span class="va">upper</span><span class="op">)</span>, </span>
<span>                 position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>,</span>
<span>                 show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Posterior"</span>,<span class="st">"Prior"</span><span class="op">)</span>,values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"inside"</span>, title<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>        legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        strip.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"From state"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Multiplicative effect"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"../paper/figures/elsa_smm.pdf"</span>,width<span class="op">=</span><span class="fl">5</span>,height<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="va">p</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="standardised-outputs-total-time-spent-in-states">Standardised outputs: total time spent in states<a class="anchor" aria-label="anchor" href="#standardised-outputs-total-time-spent-in-states"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"stdpop.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tls_educ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">nd_educ</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/totlos.html">totlos</a></span><span class="op">(</span><span class="va">mbmodscg</span>, t<span class="op">=</span><span class="fl">10</span>, new_data<span class="op">=</span><span class="fu"><a href="../reference/standardise_to.html">standardise_to</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">tlm_educ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">nd_educ</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/totlos.html">totlos</a></span><span class="op">(</span><span class="va">mbmodc</span>, t<span class="op">=</span><span class="fl">10</span>, new_data<span class="op">=</span><span class="fu"><a href="../reference/standardise_to.html">standardise_to</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">elevs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"less"</span>,<span class="st">"uppersec"</span>,<span class="st">"tertiary"</span><span class="op">)</span></span>
<span><span class="va">tles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,<span class="va">tls_educ</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>educ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">elevs</span>,levels<span class="op">=</span><span class="va">elevs</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>         state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span>,<span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op"><a href="https://mc-stan.org/posterior/reference/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">educ</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>posterior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_sum</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"semi-Markov"</span>,</span>
<span>         tdiff <span class="op">=</span> <span class="va">posterior</span> <span class="op">-</span> <span class="va">posterior</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tlem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,<span class="va">tlm_educ</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>educ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">elevs</span>, levels<span class="op">=</span><span class="va">elevs</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>         state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op"><a href="https://mc-stan.org/posterior/reference/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">educ</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>posterior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_sum</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"Markov"</span>,</span>
<span>         tdiff <span class="op">=</span> <span class="va">posterior</span> <span class="op">-</span> <span class="va">posterior</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tles</span>, <span class="va">tlem</span><span class="op">)</span> </span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">tle</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>, <span class="st">"tle.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>By age. 55, 65, 75, 85, 95, averaging over gender and education</p>
<p>Note time dependent covariate, which is why we forecast over a short
prediction interval, 10 years.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tls_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">nd_age</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/totlos.html">totlos</a></span><span class="op">(</span><span class="va">mbmodscg</span>, t<span class="op">=</span><span class="fl">10</span>, new_data<span class="op">=</span><span class="fu"><a href="../reference/standardise_to.html">standardise_to</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">tlm_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">nd_age</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/totlos.html">totlos</a></span><span class="op">(</span><span class="va">mbmodc</span>, t<span class="op">=</span><span class="fl">10</span>, new_data<span class="op">=</span><span class="fu"><a href="../reference/standardise_to.html">standardise_to</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">alevs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"50-60"</span>,<span class="st">"60-70"</span>,<span class="st">"70-80"</span>,<span class="st">"80-90"</span>,<span class="st">"90-100"</span><span class="op">)</span></span>
<span><span class="va">tles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,<span class="va">tls_age</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">alevs</span>,levels<span class="op">=</span><span class="va">alevs</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>         state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span>,<span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op"><a href="https://mc-stan.org/posterior/reference/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>posterior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_sum</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"semi-Markov"</span>,</span>
<span>         tdiff <span class="op">=</span> <span class="va">posterior</span> <span class="op">-</span> <span class="va">posterior</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tlem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,<span class="va">tlm_age</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">alevs</span>, levels<span class="op">=</span><span class="va">alevs</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>         state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op"><a href="https://mc-stan.org/posterior/reference/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>posterior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_sum</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"Markov"</span>,</span>
<span>         tdiff<span class="op">=</span><span class="va">posterior</span> <span class="op">-</span> <span class="va">posterior</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tla</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tles</span>, <span class="va">tlem</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">tla</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>, <span class="st">"tla.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>By gender</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tls_gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">nd_gender</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/totlos.html">totlos</a></span><span class="op">(</span><span class="va">mbmodscw</span>, t<span class="op">=</span><span class="fl">10</span>, new_data<span class="op">=</span><span class="fu"><a href="../reference/standardise_to.html">standardise_to</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">tlm_gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">nd_gender</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/totlos.html">totlos</a></span><span class="op">(</span><span class="va">mbmodc</span>, t<span class="op">=</span><span class="fl">10</span>, new_data<span class="op">=</span><span class="fu"><a href="../reference/standardise_to.html">standardise_to</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">alevs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nd_gender</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="va">x</span><span class="op">$</span><span class="va">gender</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,<span class="va">tls_gender</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">alevs</span>,levels<span class="op">=</span><span class="va">alevs</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>         state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op"><a href="https://mc-stan.org/posterior/reference/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>posterior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_sum</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"semi-Markov"</span>,</span>
<span>         tdiff<span class="op">=</span><span class="va">posterior</span> <span class="op">-</span> <span class="va">posterior</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tlem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,<span class="va">tlm_gender</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">alevs</span>, levels<span class="op">=</span><span class="va">alevs</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>         state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op"><a href="https://mc-stan.org/posterior/reference/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>posterior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/rvar-summaries-within-draws.html" class="external-link">rvar_sum</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"Markov"</span>,</span>
<span>         tdiff<span class="op">=</span><span class="va">posterior</span> <span class="op">-</span> <span class="va">posterior</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tlg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tles</span>, <span class="va">tlem</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">tlg</span>, file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">wd</span>, <span class="st">"tlg.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tlg</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   gender   posterior model               tdiff</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;rvar[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> woman   6.8 <span style="color: #949494;">± 0.29</span> semi-Markov   0.00 <span style="color: #949494;">± 0.00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> man     6.5 <span style="color: #949494;">± 0.30</span> semi-Markov  -0.35 <span style="color: #949494;">± 0.29</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> woman   6.9 <span style="color: #949494;">± 0.31</span> Markov        0.00 <span style="color: #949494;">± 0.00</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> man     6.5 <span style="color: #949494;">± 0.44</span> Markov       -0.44 <span style="color: #949494;">± 0.30</span></span></span></code></pre></div>
<p>Results for all comparisons in a three panel figure</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tla</span> <span class="op">&lt;-</span> <span class="va">tla</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cov<span class="op">=</span><span class="st">"Age"</span>, </span>
<span>         age <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">age</span>, <span class="st">"55"</span><span class="op">=</span><span class="st">"50-60"</span>, <span class="st">"65"</span><span class="op">=</span><span class="st">"60-70"</span>, </span>
<span>                          <span class="st">"75"</span><span class="op">=</span><span class="st">"70-80"</span>, <span class="st">"85"</span><span class="op">=</span><span class="st">"80-90"</span>,<span class="st">"95"</span><span class="op">=</span><span class="st">"90-100"</span><span class="op">)</span>,</span>
<span>         model<span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"Semi-Markov"</span><span class="op">=</span><span class="st">"semi-Markov"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">tlg</span> <span class="op">&lt;-</span> <span class="va">tlg</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cov<span class="op">=</span><span class="st">"Sex"</span>,</span>
<span>         model<span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"Semi-Markov"</span><span class="op">=</span><span class="st">"semi-Markov"</span><span class="op">)</span>,</span>
<span>         gender <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">gender</span>, <span class="st">"Male"</span><span class="op">=</span><span class="st">"man"</span>, <span class="st">"Female"</span><span class="op">=</span><span class="st">"woman"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tle</span> <span class="op">&lt;-</span> <span class="va">tle</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cov<span class="op">=</span><span class="st">"Education"</span>,</span>
<span>         model<span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"Semi-Markov"</span><span class="op">=</span><span class="st">"semi-Markov"</span><span class="op">)</span>,</span>
<span>         educ <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">educ</span>, <span class="st">"Less"</span><span class="op">=</span><span class="st">"less"</span>, </span>
<span>                           <span class="st">"Upper secondary"</span><span class="op">=</span><span class="st">"uppersec"</span>, <span class="st">"Tertiary"</span><span class="op">=</span><span class="st">"tertiary"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">psize</span> <span class="op">&lt;-</span> <span class="fl">24</span></span>
<span></span>
<span><span class="va">ga</span> <span class="op">&lt;-</span> <span class="va">tla</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">age</span>, col<span class="op">=</span><span class="va">age</span>, lty<span class="op">=</span><span class="va">model</span>, xdist<span class="op">=</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="https://mjskay.github.io/ggdist/reference/stat_pointinterval.html" class="external-link">stat_pointinterval</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu">ggstance</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggstance/man/position-vertical.html" class="external-link">position_dodgev</a></span><span class="op">(</span>height<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                             interval_size_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, fatten_point<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"none"</span>, </span>
<span>         lty <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"inside"</span>, title<span class="op">=</span><span class="st">""</span>, reverse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>        legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="fl">0.4</span><span class="op">)</span>, </span>
<span>                                         color<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">psize</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Years"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"By age"</span><span class="op">)</span></span>
<span><span class="va">ga</span></span></code></pre></div>
<p><img src="cognitive_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="va">tlg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">gender</span>, col<span class="op">=</span><span class="va">gender</span>, lty<span class="op">=</span><span class="va">model</span>, xdist<span class="op">=</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="https://mjskay.github.io/ggdist/reference/stat_pointinterval.html" class="external-link">stat_pointinterval</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu">ggstance</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggstance/man/position-vertical.html" class="external-link">position_dodgev</a></span><span class="op">(</span>height<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>,</span>
<span>                             interval_size_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, fatten_point<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"none"</span>, lty<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">psize</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Years"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"By sex"</span><span class="op">)</span></span>
<span><span class="va">gg</span></span></code></pre></div>
<p><img src="cognitive_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ge</span> <span class="op">&lt;-</span> <span class="va">tle</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">educ</span>, col<span class="op">=</span><span class="va">educ</span>, lty<span class="op">=</span><span class="va">model</span>, xdist<span class="op">=</span><span class="va">posterior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="https://mjskay.github.io/ggdist/reference/stat_pointinterval.html" class="external-link">stat_pointinterval</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu">ggstance</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggstance/man/position-vertical.html" class="external-link">position_dodgev</a></span><span class="op">(</span>height<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>,</span>
<span>                             interval_size_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, fatten_point<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"none"</span>, lty<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">psize</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Years"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"By highest level of education"</span><span class="op">)</span></span>
<span><span class="va">ge</span></span></code></pre></div>
<p><img src="cognitive_files/figure-html/unnamed-chunk-17-3.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">ga</span>, <span class="va">gg</span>, <span class="va">ge</span>, align<span class="op">=</span><span class="st">"v"</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> </span></code></pre></div>
<p><img src="cognitive_files/figure-html/unnamed-chunk-17-4.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">save_files</span><span class="op">)</span><span class="op">{</span> </span>
<span> <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"elsa_totlos.pdf"</span><span class="op">)</span></span>
<span> <span class="co">## png("elsa_totlos.png", width=640, height=640, pointsize=24)</span></span>
<span> <span class="va">p</span> </span>
<span> <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
