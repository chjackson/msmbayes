<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Phase-type expansion of a transition intensity matrix to create a non-Markov multi-state model — qphaseapprox • msmbayes</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Phase-type expansion of a transition intensity matrix to create a non-Markov multi-state model — qphaseapprox"><meta name="description" content="Convert a multi-state model intensity matrix with one or more non-Markov
states to an intensity matrix on a phase-type state space, where the
non-Markov states are modelled with a phase-type approximation of a
shape/scale distribution."><meta property="og:description" content="Convert a multi-state model intensity matrix with one or more non-Markov
states to an intensity matrix on a phase-type state space, where the
non-Markov states are modelled with a phase-type approximation of a
shape/scale distribution."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">msmbayes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/advanced.html">Advanced multi-state models in msmbayes</a></li>
    <li><a class="dropdown-item" href="../articles/examples.html">Examples of using msmbayes</a></li>
    <li><a class="dropdown-item" href="../articles/pastates.html">Examples of using msmbayes</a></li>
    <li><a class="dropdown-item" href="../articles/semimarkov.html">Semi-Markov models for intermittent observations with msmbayes</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chjackson/msmbayes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Phase-type expansion of a transition intensity matrix to create a non-Markov multi-state model</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msmbayes/blob/HEAD/R/phaseapprox.R" class="external-link"><code>R/phaseapprox.R</code></a></small>
      <div class="d-none name"><code>qphaseapprox.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Convert a multi-state model intensity matrix with one or more non-Markov
states to an intensity matrix on a phase-type state space, where the
non-Markov states are modelled with a phase-type approximation of a
shape/scale distribution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">qphaseapprox</span><span class="op">(</span></span>
<span>  <span class="va">qmatrix</span>,</span>
<span>  <span class="va">pastates</span>,</span>
<span>  <span class="va">shape</span>,</span>
<span>  <span class="va">scale</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"weibull"</span>,</span>
<span>  spline <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  att <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-qmatrix">qmatrix<a class="anchor" aria-label="anchor" href="#arg-qmatrix"></a></dt>
<dd><p>Intensity matrix on the observable state space.
Only the rates for transitions out of Markov states are used,
and values of rates for transitions out of the non-Markov state are ignored,
unless there are competing next states.  In that case
the relative value of the intensities are interpreted as the
transition probability to each next state.  These transition
probabilities are multiplied by the phase transition rates of the
sojourn distribution in the non-Markov state to get the transition
rates from the phases to the destination state.</p></dd>


<dt id="arg-shape">shape<a class="anchor" aria-label="anchor" href="#arg-shape"></a></dt>
<dd><p>shape parameter</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>scale parameter</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>parametric family approximated by the phase-type distribution: <code>"weibull"</code> or <code>"gamma"</code></p></dd>


<dt id="arg-spline">spline<a class="anchor" aria-label="anchor" href="#arg-spline"></a></dt>
<dd><p>Type of spline used to interpolate between the training points (pointwise optima) when deriving the function that best maps the shape to each phase-type parameter</p></dd>


<dt id="arg-att">att<a class="anchor" aria-label="anchor" href="#arg-att"></a></dt>
<dd><p>keep attributes indicating progression and absorption states</p>
<p>TODO do we really need these, they are messy.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Intensity matrix on the latent state space.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

