<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Phase-type expansion of a transition intensity matrix to create a non-Markov multi-state model — qphaseapprox • msmbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Phase-type expansion of a transition intensity matrix to create a non-Markov multi-state model — qphaseapprox"><meta property="og:description" content="Convert a multi-state model intensity matrix with one or more non-Markov
states to an intensity matrix on a phase-type state space, where the
non-Markov states are modelled with a phase-type approximation of a
shape/scale distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/examples.html">Examples of using msmbayes</a>
    </li>
    <li>
      <a href="../articles/misclass.html">Misclassification multi-state models in msmbayes</a>
    </li>
    <li>
      <a href="../articles/semimarkov.html">Semi-Markov models with msmbayes</a>
    </li>
    <li>
      <a href="../articles/nphase.html">Advanced phase-type models in msmbayes</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/chjackson/msmbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Phase-type expansion of a transition intensity matrix to create a non-Markov multi-state model</h1>
    <small class="dont-index">Source: <a href="https://github.com/chjackson/msmbayes/blob/HEAD/R/phaseapprox.R" class="external-link"><code>R/phaseapprox.R</code></a></small>
    <div class="hidden name"><code>qphaseapprox.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convert a multi-state model intensity matrix with one or more non-Markov
states to an intensity matrix on a phase-type state space, where the
non-Markov states are modelled with a phase-type approximation of a
shape/scale distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">qphaseapprox</span><span class="op">(</span></span>
<span>  <span class="va">qmatrix</span>,</span>
<span>  <span class="va">pastates</span>,</span>
<span>  <span class="va">shape</span>,</span>
<span>  <span class="va">scale</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"weibull"</span>,</span>
<span>  spline <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  att <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-qmatrix">qmatrix<a class="anchor" aria-label="anchor" href="#arg-qmatrix"></a></dt>
<dd><p>Intensity matrix on the observable state space.
Only the rates for transitions out of Markov states are used,
and values of rates for transitions out of the non-Markov state are ignored,
unless there are competing next states.  In that case
the relative value of the intensities are interpreted as the
transition probability to each next state.  These transition
probabilities are multiplied by the phase transition rates of the
sojourn distribution in the non-Markov state to get the transition
rates from the phases to the destination state.</p></dd>


<dt id="arg-pastates">pastates<a class="anchor" aria-label="anchor" href="#arg-pastates"></a></dt>
<dd><p>This indicates which states (if any) are given a
Weibull or Gamma sojourn distribution approximated by a 5-phase
model.
Ignored if <code>nphase</code> is supplied.</p></dd>


<dt id="arg-shape">shape<a class="anchor" aria-label="anchor" href="#arg-shape"></a></dt>
<dd><p>shape parameter</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>scale parameter</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>parametric family approximated by the phase-type distribution: <code>"weibull"</code> or <code>"gamma"</code></p></dd>


<dt id="arg-spline">spline<a class="anchor" aria-label="anchor" href="#arg-spline"></a></dt>
<dd><p>Type of spline used to interpolate between the training points (pointwise optima) when deriving the function that best maps the shape to each phase-type parameter</p></dd>


<dt id="arg-att">att<a class="anchor" aria-label="anchor" href="#arg-att"></a></dt>
<dd><p>keep attributes indicating progression and absorption states</p>
<p>TODO do we really need these, they are messy.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Intensity matrix on the latent state space.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

