<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Illustrate the empirical distribution of states against time in intermittently-observed multistate data — msmhist • msmbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Illustrate the empirical distribution of states against time in intermittently-observed multistate data — msmhist"><meta property="og:description" content="This works similarly to a histogram.  The state observations are
binned into time intervals with roughly equal numbers of
observations.  Within each bin, the probability \(p(s)\) that an
observation comes from each state \(s\) is estimated."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msmbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/examples.html">Examples of using msmbayes</a>
    </li>
    <li>
      <a href="../articles/misclass.html">Misclassification multi-state models in msmbayes</a>
    </li>
    <li>
      <a href="../articles/semimarkov.html">Semi-Markov models with msmbayes</a>
    </li>
    <li>
      <a href="../articles/nphase.html">Advanced phase-type models in msmbayes</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/chjackson/msmbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Illustrate the empirical distribution of states against time in intermittently-observed multistate data</h1>
    <small class="dont-index">Source: <a href="https://github.com/chjackson/msmbayes/blob/HEAD/R/msmhist.R" class="external-link"><code>R/msmhist.R</code></a></small>
    <div class="hidden name"><code>msmhist.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This works similarly to a histogram.  The state observations are
binned into time intervals with roughly equal numbers of
observations.  Within each bin, the probability \(p(s)\) that an
observation comes from each state \(s\) is estimated.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">msmhist</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  state <span class="op">=</span> <span class="st">"state"</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  subject <span class="op">=</span> <span class="st">"subject"</span>,</span>
<span>  <span class="va">nbins</span>,</span>
<span>  absorbing <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  censtimes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stacked <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame giving the observed data.</p></dd>


<dt id="arg-state">state<a class="anchor" aria-label="anchor" href="#arg-state"></a></dt>
<dd><p>Character string naming the observed state variable in
the data.  This variable must either be an integer in 1,2,...,K,
where K is the number of states, or a factor with these integers
as level labels.  If omitted, this is assumed to be <code>"state"</code>.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Character string naming the observation time variable in the data.
If omitted, this is assumed to be <code>"time"</code>.</p></dd>


<dt id="arg-subject">subject<a class="anchor" aria-label="anchor" href="#arg-subject"></a></dt>
<dd><p>Character string naming the individual ID variable in the data.
If omitted, this is assumed to be <code>"subject"</code>.</p></dd>


<dt id="arg-nbins">nbins<a class="anchor" aria-label="anchor" href="#arg-nbins"></a></dt>
<dd><p>Number of time intervals to bin the state observations
into.  The underlying distribution of states illustrated by the
plot will be assumed constant within each interval.</p></dd>


<dt id="arg-absorbing">absorbing<a class="anchor" aria-label="anchor" href="#arg-absorbing"></a></dt>
<dd><p>Indices of any absorbing states.  Individuals are
assumed to stay in their absorbing state, and contribute one
observation to each bin after their absorption time.  By default,
no states are assumed to be absorbing.</p></dd>


<dt id="arg-censtimes">censtimes<a class="anchor" aria-label="anchor" href="#arg-censtimes"></a></dt>
<dd><p>Vector of maximum intended follow-up times for the
people in the data who entered absorbing states.  This supposes
that had the person not entered the absorbing state, they would
not have been observed after this time.</p></dd>


<dt id="arg-stacked">stacked<a class="anchor" aria-label="anchor" href="#arg-stacked"></a></dt>
<dd><p>If <code>TRUE</code> do a bar chart with the probabilities
for different states stacked on top of each other, so the y-axis
spans 0 to 1 exactly.  This is more compact.</p>
<p>If <code>FALSE</code>, plot one panel per state, as is done in
<code>prevalence.msm</code>.  This is more convenient for constructing a check
of the model fit.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>ggplot2</code> plot object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>If each subject has at most one observation in a bin, then \(p(s)\)
is estimated as the proportion of observations in the bin that are
of that state.</p>
<p>More generally, if an individual has more than one observation in
the bin, \(p(s)\) is estimated as follows. For each observed
individual \(i\) and each state \(s\), we define a variable
\(p(i,s)\) equal to the proportion of individual \(i\)'s
observations that are of state \(s\). For example, in a
three-state model, where a person has two observations in a bin,
and these are states 2 and 3, then \(p(i,s) = 0, 0.5, 0.5\) for
states 1, 2 and 3 respectively.  The bin-specific estimate of
\(p(s)\) is then the average of \(p(i,s)\) over individuals
\(s\) who have at least one observation in that bin.</p>
<p>The results are visualised as a stacked bar plot.  The individual
observations of states are represented as points placed at random y
positions within each state-specific bar.</p>
<p>This is intended as an alternative to the "observed prevalences"
plot in the function <code>prevalence.msm</code> from the <code>msm</code> package,
with a clearer connection to the data.   It can be overlaid
with predictions of transition probabilities from a <code>msmbayes</code>
or <code>msm</code> model, to check the fit of the model.</p>
<p>The method used by "observed prevalences" plots places a strong
assumption on the (unobserved) individual data, that individuals
stay in the same state between observations, or transition at the
midpoint between observations.</p>
<p><code>msmhist</code> places no assumption on the individual data.  Instead
the assumption is placed on the distribution underlying the data.
In a similar fashion to a histogram, it assumes that the
distribution of states is the same at all times within each
time interval bin.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="msmhist_bardata.html">msmhist_bardata</a></code> to extract the numbers
behind this plot so the plot can be customised by hand.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">msmhist</span><span class="op">(</span><span class="va">infsim</span>, <span class="st">"state"</span>, <span class="st">"months"</span>, <span class="st">"subject"</span>, nbins<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msmhist-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">msmhist</span><span class="op">(</span><span class="va">infsim2</span>, <span class="st">"state"</span>, <span class="st">"months"</span>, <span class="st">"subject"</span>, nbins<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msmhist-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

