<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This works similarly to a histogram.  The state observations are
binned into time intervals with roughly equal numbers of
observations.  Within each bin, the probability \(p(s)\) that an
observation comes from each state \(s\) is estimated."><title>Illustrate the empirical distribution of states against time
in intermittently-observed multistate data — msmhist • msmbayes</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Illustrate the empirical distribution of states against time
in intermittently-observed multistate data — msmhist"><meta property="og:description" content="This works similarly to a histogram.  The state observations are
binned into time intervals with roughly equal numbers of
observations.  Within each bin, the probability \(p(s)\) that an
observation comes from each state \(s\) is estimated."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">msmbayes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/advanced.html">Advanced multi-state models in msmbayes</a>
    <a class="dropdown-item" href="../articles/examples.html">Examples of using msmbayes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chjackson/msmbayes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Illustrate the empirical distribution of states against time
in intermittently-observed multistate data</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msmbayes/blob/HEAD/R/msmhist.R" class="external-link"><code>R/msmhist.R</code></a></small>
      <div class="d-none name"><code>msmhist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This works similarly to a histogram.  The state observations are
binned into time intervals with roughly equal numbers of
observations.  Within each bin, the probability \(p(s)\) that an
observation comes from each state \(s\) is estimated.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">msmhist</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">state</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">subject</span>,</span>
<span>  <span class="va">nbins</span>,</span>
<span>  absorbing <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  censtimes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stacked <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>Data frame giving the observed data.</p></dd>


<dt>state</dt>
<dd><p>Character string naming the observed state variable in
the data.  This variable must either be an integer in 1,2,...,K,
where K is the number of states, or a factor with these integers
as level labels.</p></dd>


<dt>time</dt>
<dd><p>Character string naming the observation time variable in the data</p></dd>


<dt>subject</dt>
<dd><p>Character string naming the individual ID variable in the data</p></dd>


<dt>nbins</dt>
<dd><p>Number of time intervals to bin the state observations
into.  The underlying distribution of states illustrated by the
plot will be assumed constant within each interval.</p></dd>


<dt>absorbing</dt>
<dd><p>Indices of any absorbing states.  Individuals are
assumed to stay in their absorbing state, and contribute one
observation to each bin after their absorption time.  By default,
no states are assumed to be absorbing.</p></dd>


<dt>censtimes</dt>
<dd><p>Vector of maximum intended follow-up times for the
people in the data who entered absorbing states.  This supposes
that had the person not entered the absorbing state, they would
not have been observed after this time.</p></dd>


<dt>stacked</dt>
<dd><p>If <code>TRUE</code> do a bar chart with the probabilities
for different states stacked on top of each other, so the y-axis
spans 0 to 1 exactly.  This is more compact.</p>
<p>If <code>FALSE</code>, plot one panel per state, as is done in
<code>prevalence.msm</code>.  This is more convenient for constructing a check
of the model fit.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>ggplot2</code> plot object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If each subject has at most one observation in a bin, then \(p(s)\)
is estimated as the proportion of observations in the bin that are
of that state.</p>
<p>More generally, if an individual has more than one observation in
the bin, \(p(s)\) is estimated as follows. For each observed
individual \(i\) and each state \(s\), we define a variable
\(p(i,s)\) equal to the proportion of individual \(i\)'s
observations that are of state \(s\). For example, in a
three-state model, where a person has two observations in a bin,
and these are states 2 and 3, then \(p(i,s) = 0, 0.5, 0.5\) for
states 1, 2 and 3 respectively.  The bin-specific estimate of
\(p(s)\) is then the average of \(p(i,s)\) over individuals
\(s\) who have at least one observation in that bin.</p>
<p>The results are visualised as a stacked bar plot.  The individual
observations of states are represented as points placed at random y
positions within each state-specific bar.</p>
<p>This is intended as an alternative to the "observed prevalences"
plot in the function <code>prevalence.msm</code> from the <code>msm</code> package,
with a clearer connection to the data.   It can be overlaid
with predictions of transition probabilities from a <code>msmbayes</code>
or <code>msm</code> model, to check the fit of the model.</p>
<p>The method used by "observed prevalences" plots places a strong
assumption on the individual data, that individuals stay in the
same state between observations, or transition at the midpoint
between observations.</p>
<p><code>msmhist</code> places no assumption on the individual data.  Instead
the assumption is placed on the distribution underlying the data.
The histogram-like visualisation assumes, essentially, that the
distribution of states is the same at all times within each bin.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="msmhist_bardata.html">msmhist_bardata</a></code> to extract the numbers
behind this plot so the plot can be customised by hand.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">msmhist</span><span class="op">(</span><span class="va">infsim</span>, <span class="st">"state"</span>, <span class="st">"months"</span>, <span class="st">"subject"</span>, nbins<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msmhist-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">msmhist</span><span class="op">(</span><span class="va">infsim2</span>, <span class="st">"state"</span>, <span class="st">"months"</span>, <span class="st">"subject"</span>, nbins<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="msmhist-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

